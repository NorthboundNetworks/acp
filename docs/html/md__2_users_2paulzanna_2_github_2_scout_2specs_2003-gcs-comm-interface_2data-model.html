<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ACP - Autonomous Command Protocol: Data Model: Secure Control Protocol (SCP) v1.1</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ACP - Autonomous Command Protocol<span id="projectnumber">&#160;v0.3.0</span>
   </div>
   <div id="projectbrief">Portable C99 framing library with COBS, CRC16, and HMAC-SHA256 authentication</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md__2_users_2paulzanna_2_github_2_scout_2specs_2003-gcs-comm-interface_2data-model.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Data Model: Secure Control Protocol (SCP) v1.1 </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md8789"></a></p>
<p><b>Phase 1 Design Output</b> <br  />
 <b>Date</b>: 2025-10-26</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md8790"></a>
Core Entities</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8791"></a>
SCP Message Frame</h2>
<p>Primary protocol data structure for all communication.</p>
<p><b>Fields</b>:</p>
<ul>
<li><span class="tt">sync</span>: 2 bytes - Start marker (0xAA, 0x55)</li>
<li><span class="tt">version</span>: 1 byte - Protocol version (0x01 for SCP v1.1)</li>
<li><span class="tt">msg_type</span>: 1 byte - Message identifier (command/telemetry/response)</li>
<li><span class="tt">seq_num</span>: 1 byte - Per-session sequence number for replay protection</li>
<li><span class="tt">flags</span>: 1 byte - Bitfield (0x01=auth present, 0x02=compressed)</li>
<li><span class="tt">length</span>: 2 bytes - Payload size including auth_tag if present</li>
<li><span class="tt">payload</span>: N bytes - Message body (COBS-encoded)</li>
<li><span class="tt">auth_tag</span>: 16 bytes (optional) - HMAC-SHA256 truncated authentication</li>
<li><span class="tt">crc16</span>: 2 bytes - CRC-16-CCITT checksum</li>
</ul>
<p><b>Validation Rules</b>:</p>
<ul>
<li>Maximum frame size: 512 bytes total</li>
<li>Sequence numbers must increment within session</li>
<li>CRC must validate entire frame</li>
<li>Authentication tag required for command messages</li>
</ul>
<p><b>State Transitions</b>:</p>
<ul>
<li>Raw bytes → COBS decoded → Validated frame → Processed message</li>
</ul>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md8793"></a>
Operator Session</h2>
<p>Authentication and authorization context for GCS connections.</p>
<p><b>Fields</b>:</p>
<ul>
<li><span class="tt">session_id</span>: 4 bytes - Unique session identifier</li>
<li><span class="tt">operator_role</span>: 1 byte - Role type (Mission Commander=1, Pilot=2, Observer=3)</li>
<li><span class="tt">auth_key</span>: 32 bytes - HMAC key for message authentication</li>
<li><span class="tt">last_seq_num</span>: 1 byte - Last received sequence number</li>
<li><span class="tt">created_time</span>: 4 bytes - Session creation timestamp (ms)</li>
<li><span class="tt">last_activity</span>: 4 bytes - Last message timestamp (ms)</li>
<li><span class="tt">connection_type</span>: 1 byte - Transport (UART=1, USB=2, SPI=3)</li>
<li><span class="tt">rate_limit_state</span>: Rate limiting tracking structure</li>
</ul>
<p><b>Validation Rules</b>:</p>
<ul>
<li>Session timeout: 15 minutes of inactivity</li>
<li>Maximum 3 concurrent sessions</li>
<li>Sequence numbers must be monotonic increasing</li>
<li>Authentication key must be 256-bit</li>
</ul>
<p><b>Relationships</b>:</p>
<ul>
<li>One session per GCS connection</li>
<li>Sessions link to operator role definitions</li>
<li>Sessions track message history for replay protection</li>
</ul>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md8795"></a>
Command Message</h2>
<p>Inbound control messages from ground operators to drone.</p>
<p><b>Message Types</b>:</p>
<ul>
<li><span class="tt">CMD_CONTROL</span> (0x01) - Arm/disarm and mode changes</li>
<li><span class="tt">CMD_GIMBAL</span> (0x02) - Gimbal positioning commands <br  />
</li>
<li><span class="tt">CMD_CONFIG</span> (0x03) - System configuration updates</li>
</ul>
<p><b>Common Fields</b>:</p>
<ul>
<li><span class="tt">session_id</span>: 4 bytes - Originating session</li>
<li><span class="tt">timestamp</span>: 4 bytes - Command timestamp (ms)</li>
<li><span class="tt">priority</span>: 1 byte - Message priority (Emergency=1, Normal=2, Low=3)</li>
</ul>
<p><b>CMD_CONTROL Payload</b>:</p>
<ul>
<li><span class="tt">action</span>: 1 byte - ARM=1, DISARM=2, MODE_CHANGE=3</li>
<li><span class="tt">mode</span>: 1 byte - HOVER=0, LOITER=1, FORWARD=2</li>
<li><span class="tt">params</span>: 8 bytes - Mode-specific parameters</li>
</ul>
<p><b>CMD_GIMBAL Payload</b>:</p>
<ul>
<li><span class="tt">pan_angle</span>: 2 bytes - Pan angle in degrees × 100</li>
<li><span class="tt">tilt_angle</span>: 2 bytes - Tilt angle in degrees × 100 <br  />
</li>
<li><span class="tt">movement_speed</span>: 1 byte - Movement rate (0-255)</li>
</ul>
<p><b>Validation Rules</b>:</p>
<ul>
<li>Commands require authentication for execution</li>
<li>Role authorization enforced per operator type</li>
<li>Rate limiting applied per operator session</li>
</ul>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md8797"></a>
Telemetry Message</h2>
<p>Outbound status and sensor data from drone to operators.</p>
<p><b>Message Types</b>:</p>
<ul>
<li><span class="tt">TLM_STATUS</span> (0x10) - Basic flight status and position</li>
<li><span class="tt">TLM_GIMBAL</span> (0x11) - Gimbal position and status</li>
<li><span class="tt">TLM_AUDIT</span> (0x12) - Security and command audit events</li>
<li><span class="tt">TLM_MISSION</span> (0x13) - Mission progress summaries</li>
</ul>
<p><b>TLM_STATUS Payload</b>:</p>
<ul>
<li><span class="tt">armed</span>: 1 byte - Arm state (0=disarmed, 1=armed)</li>
<li><span class="tt">mode</span>: 1 byte - Current flight mode</li>
<li><span class="tt">gps_fix</span>: 1 byte - GPS fix quality (0-3)</li>
<li><span class="tt">battery_percent</span>: 1 byte - Battery level (0-100)</li>
<li><span class="tt">attitude</span>: 6 bytes - Roll, pitch, yaw (degrees × 100)</li>
<li><span class="tt">position</span>: 12 bytes - Latitude, longitude, altitude (cm precision)</li>
<li><span class="tt">uptime_ms</span>: 4 bytes - System uptime</li>
<li><span class="tt">timestamp_ms</span>: 4 bytes - Message timestamp</li>
</ul>
<p><b>TLM_AUDIT Payload</b>:</p>
<ul>
<li><span class="tt">event_type</span>: 1 byte - Command, security violation, session event</li>
<li><span class="tt">source_session</span>: 4 bytes - Session ID if applicable</li>
<li><span class="tt">operator_role</span>: 1 byte - Role of operator</li>
<li><span class="tt">result_code</span>: 1 byte - Success/failure/rejection reason</li>
<li><span class="tt">timestamp_ms</span>: 4 bytes - Event timestamp</li>
<li><span class="tt">details</span>: 16 bytes - Event-specific details</li>
</ul>
<p><b>Generation Rules</b>:</p>
<ul>
<li>Status telemetry transmitted at configured rate (1-10 Hz)</li>
<li>Audit messages generated for all command attempts</li>
<li>Telemetry includes session tagging for multi-operator scenarios</li>
</ul>
<hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md8799"></a>
Response Message</h2>
<p>Acknowledgment and error messages for command processing.</p>
<p><b>Message Types</b>:</p>
<ul>
<li><span class="tt">ACK_RESPONSE</span> (0x20) - Command acknowledgment</li>
<li><span class="tt">ERR_RESPONSE</span> (0x21) - Error and rejection responses</li>
</ul>
<p><b>ACK_RESPONSE Payload</b>:</p>
<ul>
<li><span class="tt">acked_seq_num</span>: 1 byte - Sequence number being acknowledged <br  />
</li>
<li><span class="tt">session_id</span>: 4 bytes - Session identifier</li>
<li><span class="tt">result_code</span>: 1 byte - Processing result</li>
<li><span class="tt">execution_time</span>: 2 bytes - Command processing time (ms)</li>
</ul>
<p><b>ERR_RESPONSE Payload</b>:</p>
<ul>
<li><span class="tt">error_code</span>: 1 byte - Error type (CRC_FAIL=0x02, AUTH_FAIL=0x04, etc.)</li>
<li><span class="tt">failed_seq_num</span>: 1 byte - Sequence number that failed</li>
<li><span class="tt">session_id</span>: 4 bytes - Session if available <br  />
</li>
<li><span class="tt">error_details</span>: 8 bytes - Additional error context</li>
</ul>
<p><b>Response Rules</b>:</p>
<ul>
<li>All commands generate either ACK or ERR response</li>
<li>Response transmitted within 100ms of command receipt</li>
<li>Error responses include diagnostic information for troubleshooting</li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md8801"></a>
Role Authorization Matrix</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command Type  </th><th class="markdownTableHeadNone">Mission Commander  </th><th class="markdownTableHeadNone">Pilot  </th><th class="markdownTableHeadNone">Observer  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ARM/DISARM  </td><td class="markdownTableBodyNone">✅ Allow  </td><td class="markdownTableBodyNone">✅ Allow  </td><td class="markdownTableBodyNone">❌ Deny  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Mode Change  </td><td class="markdownTableBodyNone">✅ Allow  </td><td class="markdownTableBodyNone">✅ Allow  </td><td class="markdownTableBodyNone">❌ Deny  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Gimbal Control  </td><td class="markdownTableBodyNone">✅ Allow  </td><td class="markdownTableBodyNone">✅ Allow  </td><td class="markdownTableBodyNone">✅ Allow  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Configuration  </td><td class="markdownTableBodyNone">✅ Allow  </td><td class="markdownTableBodyNone">❌ Deny  </td><td class="markdownTableBodyNone">❌ Deny  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Emergency Stop  </td><td class="markdownTableBodyNone">✅ Allow  </td><td class="markdownTableBodyNone">✅ Allow  </td><td class="markdownTableBodyNone">✅ Allow  </td></tr>
</table>
<p><b>Conflict Resolution Priority</b>: Mission Commander &gt; Pilot &gt; Observer</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md8803"></a>
Rate Limiting Structure</h1>
<p><b>Per-Operator Limits</b>:</p>
<ul>
<li>Sustained rate: 5 commands/second</li>
<li>Burst allowance: 20 commands/second <br  />
</li>
<li>Burst window: 4 seconds</li>
<li>Penalty timeout: 10 seconds for violations</li>
</ul>
<p><b>Rate Limit State</b>:</p>
<ul>
<li><span class="tt">command_count</span>: Current commands in window</li>
<li><span class="tt">window_start</span>: Window start timestamp</li>
<li><span class="tt">burst_used</span>: Burst allowance consumed</li>
<li><span class="tt">penalty_until</span>: Penalty timeout expiration</li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md8805"></a>
Message Priority Queue</h1>
<p><b>Priority Levels</b>:</p>
<ol type="1">
<li>Emergency (ARM/DISARM, Emergency Stop) - Always processed</li>
<li>High (Mode changes from Mission Commander) - Priority queue</li>
<li>Normal (Standard commands) - Normal queue <br  />
</li>
<li>Low (Telemetry requests, status queries) - Background queue</li>
</ol>
<p><b>Queue Management</b>:</p>
<ul>
<li>Emergency messages bypass all rate limiting</li>
<li>Higher priority operators can preempt lower priority queues</li>
<li>Telemetry generation can be throttled under load</li>
<li>Queue overflow drops lowest priority messages first </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on <span class="timestamp"></span> for ACP - Autonomous Command Protocol by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
