<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ACP - Autonomous Command Protocol: Arming Scenarios Integration Test</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ACP - Autonomous Command Protocol<span id="projectnumber">&#160;v0.3.0</span>
   </div>
   <div id="projectbrief">Portable C99 framing library with COBS, CRC16, and HMAC-SHA256 authentication</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md__2_users_2paulzanna_2_github_2_scout_2tests_2integration_2arming__scenarios.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Arming Scenarios Integration Test </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md8939"></a></p>
<p>Comprehensive integration testing for preflight checks and arming scenarios via CLI interface. Tests end-to-end behavior from operator commands through safety gates to system state changes.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md8940"></a>
Test Environment Setup</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8941"></a>
Hardware Requirements</h2>
<ul>
<li>ESP32-S3 development board with Scout firmware</li>
<li>Serial console connection (USB-C)</li>
<li>All sensors connected and functional per <span class="tt">sensor_bench_tests.md</span></li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8942"></a>
Software Requirements</h2>
<ul>
<li>Serial terminal (screen, minicom, or VS Code terminal)</li>
<li>Python 3.x with pySerial for automated testing</li>
<li>Firmware with complete Phase 4 safety system</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md8943"></a>
Manual Test Scenarios</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8944"></a>
Scenario 1: Basic Arming Flow (Happy Path)</h2>
<p><b>Objective</b>: Verify normal arming sequence when all conditions are met.</p>
<p><b>Prerequisites</b>:</p>
<ul>
<li>System in CONFIG mode (default at boot)</li>
<li>All sensors healthy</li>
<li>Good link quality</li>
</ul>
<p><b>Test Procedure</b>:</p>
<ol type="1">
<li>Connect serial console, reset device</li>
<li>Verify boot complete: <span class="tt">Scout v1.0.0 starting...</span></li>
<li>Check initial status: <span class="tt">status</span></li>
<li>Attempt arming in CONFIG mode: <span class="tt">arm</span></li>
<li>Switch to FLIGHT mode: <span class="tt">mode flight</span></li>
<li>Check status again: <span class="tt">status</span></li>
<li>Attempt arming: <span class="tt">arm</span></li>
<li>Verify armed state: <span class="tt">status</span></li>
<li>Disarm: <span class="tt">disarm</span></li>
</ol>
<p><b>Expected Results</b>:</p>
<div class="fragment"><div class="line">Step 4: Cannot arm: Arming blocked in CONFIG mode - switch to FLIGHT mode first</div>
<div class="line">Step 6: Mode: FLIGHT, Armed: false, Health: All systems healthy</div>
<div class="line">Step 8: Mode: FLIGHT, Armed: true, Health: All systems healthy</div>
<div class="line">Step 9: Mode: FLIGHT, Armed: false, Disarmed by operator</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md8945"></a>
Scenario 2: Sensor Health Blocking</h2>
<p><b>Objective</b>: Verify arming is blocked when critical sensors are unhealthy.</p>
<p><b>Test Procedure</b>:</p>
<ol type="1">
<li>Set FLIGHT mode: <span class="tt">mode flight</span></li>
<li>Check sensor status: <span class="tt">sensor all</span></li>
<li>Simulate IMU fault: <span class="tt">sensor fault imu</span> (if available)</li>
<li>Attempt arming: <span class="tt">arm</span></li>
<li>Check detailed health: <span class="tt">health</span></li>
<li>Clear fault: <span class="tt">sensor clear imu</span></li>
<li>Attempt arming again: <span class="tt">arm</span></li>
</ol>
<p><b>Expected Results</b>:</p>
<div class="fragment"><div class="line">Step 4: Cannot arm: Arming blocked - required sensors not healthy</div>
<div class="line">Step 5: IMU: faulted, MAG: healthy, BARO: healthy, GPS: healthy</div>
<div class="line">Step 7: Armed successfully</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md8946"></a>
Scenario 3: Link Quality Degradation</h2>
<p><b>Objective</b>: Verify arming blocked with poor link quality.</p>
<p><b>Test Procedure</b>:</p>
<ol type="1">
<li>Set FLIGHT mode: <span class="tt">mode flight</span></li>
<li>Check link status: <span class="tt">status</span></li>
<li>Simulate poor link: <span class="tt">link quality 30</span> (if available)</li>
<li>Attempt arming: <span class="tt">arm</span></li>
<li>Restore link: <span class="tt">link quality 80</span></li>
<li>Attempt arming: <span class="tt">arm</span></li>
</ol>
<p><b>Expected Results</b>:</p>
<div class="fragment"><div class="line">Step 4: Cannot arm: Arming blocked - preflight checks failed</div>
<div class="line">Step 6: Armed successfully</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md8947"></a>
Scenario 4: CPU Budget Exceeded</h2>
<p><b>Objective</b>: Verify CPU budget enforcement blocks arming.</p>
<p><b>Test Procedure</b>:</p>
<ol type="1">
<li>Set FLIGHT mode: <span class="tt">mode flight</span></li>
<li>Check CPU usage: <span class="tt">status</span></li>
<li>Simulate high CPU load: <span class="tt">stress cpu 80</span> (if available)</li>
<li>Attempt arming: <span class="tt">arm</span></li>
<li>Stop stress test: <span class="tt">stress stop</span></li>
<li>Attempt arming: <span class="tt">arm</span></li>
</ol>
<p><b>Expected Results</b>:</p>
<div class="fragment"><div class="line">Step 4: Cannot arm: Arming blocked - CPU budget exceeded</div>
<div class="line">Step 6: Armed successfully</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md8948"></a>
Scenario 5: Vehicle Launch Envelope</h2>
<p><b>Objective</b>: Verify vehicle launch checks for moving platform arming.</p>
<p><b>Test Procedure</b>:</p>
<ol type="1">
<li>Set FLIGHT mode: <span class="tt">mode flight</span></li>
<li>Simulate vehicle movement: <span class="tt">sim vehicle speed 20 roll 5 pitch 3</span></li>
<li>Attempt arming: <span class="tt">arm</span></li>
<li>Simulate excessive speed: <span class="tt">sim vehicle speed 90</span></li>
<li>Attempt arming: <span class="tt">arm</span></li>
<li>Reset vehicle state: <span class="tt">sim vehicle speed 0</span></li>
<li>Attempt arming: <span class="tt">arm</span></li>
</ol>
<p><b>Expected Results</b>:</p>
<div class="fragment"><div class="line">Step 3: Armed successfully (within envelope)</div>
<div class="line">Step 5: Cannot arm: Arming blocked - vehicle-launch envelope not satisfied</div>
<div class="line">Step 7: Armed successfully</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md8949"></a>
Scenario 6: Failsafe Link Loss</h2>
<p><b>Objective</b>: Verify automatic disarm on link loss.</p>
<p><b>Test Procedure</b>:</p>
<ol type="1">
<li>Set FLIGHT mode and arm: <span class="tt">mode flight</span> â†’ <span class="tt">arm</span></li>
<li>Verify armed: <span class="tt">status</span></li>
<li>Simulate link loss: <span class="tt">link disconnect</span> (or physically disconnect)</li>
<li>Wait 1-2 seconds</li>
<li>Reconnect: <span class="tt">link connect</span></li>
<li>Check status: <span class="tt">status</span></li>
</ol>
<p><b>Expected Results</b>:</p>
<div class="fragment"><div class="line">Step 2: Mode: FLIGHT, Armed: true</div>
<div class="line">Step 6: Mode: CONFIG, Armed: false, Last fault: Disarmed due to link loss</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md8950"></a>
Automated Test Scripts</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8951"></a>
Arming Flow Validation Script</h2>
<p>Create <span class="tt">/tests/integration/scripts/arming_flow_test.py</span>:</p>
<div class="fragment"><div class="line"><span class="comment">#!/usr/bin/env python3</span></div>
<div class="line"><span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">Automated arming flow validation test.</span></div>
<div class="line"><span class="stringliteral">Tests complete arming scenarios via CLI commands.</span></div>
<div class="line"><span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> serial</div>
<div class="line"><span class="keyword">import</span> time</div>
<div class="line"><span class="keyword">import</span> sys</div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>send_command(ser, command, expect=None, timeout=5):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;Send command and optionally wait for expected response.&quot;&quot;&quot;</span></div>
<div class="line">    print(f<span class="stringliteral">&quot;Sending: {command}&quot;</span>)</div>
<div class="line">    ser.write(f<span class="stringliteral">&quot;{command}\r\n&quot;</span>.encode())</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> expect:</div>
<div class="line">        start_time = time.time()</div>
<div class="line">        response = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">while</span> time.time() - start_time &lt; timeout:</div>
<div class="line">            <span class="keywordflow">if</span> ser.in_waiting:</div>
<div class="line">                response += ser.read(ser.in_waiting).decode(<span class="stringliteral">&#39;utf-8&#39;</span>, errors=<span class="stringliteral">&#39;ignore&#39;</span>)</div>
<div class="line">                <span class="keywordflow">if</span> expect <span class="keywordflow">in</span> response:</div>
<div class="line">                    print(f<span class="stringliteral">&quot;  âœ“ Found: {expect}&quot;</span>)</div>
<div class="line">                    <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line">            time.sleep(0.1)</div>
<div class="line">        </div>
<div class="line">        print(f<span class="stringliteral">&quot;  âœ— Timeout waiting for: {expect}&quot;</span>)</div>
<div class="line">        print(f<span class="stringliteral">&quot;    Got: {response}&quot;</span>)</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line">    <span class="keywordflow">else</span>:</div>
<div class="line">        time.sleep(0.5)  <span class="comment"># Wait for command to process</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>test_basic_arming_flow(port):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;Test basic arming flow scenario.&quot;&quot;&quot;</span></div>
<div class="line">    print(<span class="stringliteral">&quot;Testing basic arming flow...&quot;</span>)</div>
<div class="line">    </div>
<div class="line">    ser = serial.Serial(port, 115200, timeout=2)</div>
<div class="line">    time.sleep(2)  <span class="comment"># Wait for boot</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment"># Clear buffer</span></div>
<div class="line">    ser.reset_input_buffer()</div>
<div class="line">    </div>
<div class="line">    <span class="comment"># Test 1: Arming blocked in CONFIG mode</span></div>
<div class="line">    <span class="keywordflow">if</span> <span class="keywordflow">not</span> send_command(ser, <span class="stringliteral">&quot;arm&quot;</span>, <span class="stringliteral">&quot;CONFIG mode&quot;</span>):</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment"># Test 2: Switch to FLIGHT mode</span></div>
<div class="line">    <span class="keywordflow">if</span> <span class="keywordflow">not</span> send_command(ser, <span class="stringliteral">&quot;mode flight&quot;</span>, <span class="stringliteral">&quot;FLIGHT&quot;</span>):</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment"># Test 3: Successful arming</span></div>
<div class="line">    <span class="keywordflow">if</span> <span class="keywordflow">not</span> send_command(ser, <span class="stringliteral">&quot;arm&quot;</span>, <span class="stringliteral">&quot;Armed successfully&quot;</span>):</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment"># Test 4: Disarm</span></div>
<div class="line">    <span class="keywordflow">if</span> <span class="keywordflow">not</span> send_command(ser, <span class="stringliteral">&quot;disarm&quot;</span>, <span class="stringliteral">&quot;Disarmed&quot;</span>):</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line">    </div>
<div class="line">    ser.close()</div>
<div class="line">    print(<span class="stringliteral">&quot;âœ“ Basic arming flow test passed&quot;</span>)</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>test_sensor_health_blocking(port):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;Test sensor health blocking scenario.&quot;&quot;&quot;</span></div>
<div class="line">    print(<span class="stringliteral">&quot;Testing sensor health blocking...&quot;</span>)</div>
<div class="line">    </div>
<div class="line">    ser = serial.Serial(port, 115200, timeout=2)</div>
<div class="line">    time.sleep(2)</div>
<div class="line">    </div>
<div class="line">    ser.reset_input_buffer()</div>
<div class="line">    </div>
<div class="line">    <span class="comment"># Ensure FLIGHT mode</span></div>
<div class="line">    send_command(ser, <span class="stringliteral">&quot;mode flight&quot;</span>)</div>
<div class="line">    </div>
<div class="line">    <span class="comment"># Check if we can simulate sensor faults</span></div>
<div class="line">    send_command(ser, <span class="stringliteral">&quot;help sensor&quot;</span>, timeout=2)</div>
<div class="line">    </div>
<div class="line">    <span class="comment"># Basic sensor status check</span></div>
<div class="line">    <span class="keywordflow">if</span> <span class="keywordflow">not</span> send_command(ser, <span class="stringliteral">&quot;sensor all&quot;</span>, <span class="stringliteral">&quot;healthy&quot;</span>, timeout=3):</div>
<div class="line">        print(<span class="stringliteral">&quot;Warning: Could not verify sensor status&quot;</span>)</div>
<div class="line">    </div>
<div class="line">    ser.close()</div>
<div class="line">    print(<span class="stringliteral">&quot;âœ“ Sensor health test completed (limited without fault simulation)&quot;</span>)</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <span class="keywordflow">if</span> len(sys.argv) != 2:</div>
<div class="line">        print(<span class="stringliteral">&quot;Usage: python3 arming_flow_test.py &lt;serial_port&gt;&quot;</span>)</div>
<div class="line">        print(<span class="stringliteral">&quot;Example: python3 arming_flow_test.py /dev/ttyUSB0&quot;</span>)</div>
<div class="line">        sys.exit(1)</div>
<div class="line">    </div>
<div class="line">    port = sys.argv[1]</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        success = <span class="keyword">True</span></div>
<div class="line">        success &amp;= test_basic_arming_flow(port)</div>
<div class="line">        success &amp;= test_sensor_health_blocking(port)</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span> success:</div>
<div class="line">            print(<span class="stringliteral">&quot;\nâœ“ ALL ARMING TESTS PASSED&quot;</span>)</div>
<div class="line">            sys.exit(0)</div>
<div class="line">        <span class="keywordflow">else</span>:</div>
<div class="line">            print(<span class="stringliteral">&quot;\nâœ— SOME TESTS FAILED&quot;</span>)</div>
<div class="line">            sys.exit(1)</div>
<div class="line">            </div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        print(f<span class="stringliteral">&quot;Test error: {e}&quot;</span>)</div>
<div class="line">        sys.exit(1)</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md8952"></a>
Safety Gate Stress Test</h2>
<p>Create <span class="tt">/tests/integration/scripts/safety_stress_test.py</span>:</p>
<div class="fragment"><div class="line"><span class="comment">#!/usr/bin/env python3</span></div>
<div class="line"><span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">Safety gate stress test - rapid arming/disarming with changing conditions.</span></div>
<div class="line"><span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> serial</div>
<div class="line"><span class="keyword">import</span> time</div>
<div class="line"><span class="keyword">import</span> random</div>
<div class="line"><span class="keyword">import</span> sys</div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>stress_test_safety_gates(port, duration_sec=60):</div>
<div class="line">    <span class="stringliteral">&quot;&quot;&quot;Perform stress testing of safety gates.&quot;&quot;&quot;</span></div>
<div class="line">    print(f<span class="stringliteral">&quot;Starting {duration_sec}s safety gate stress test...&quot;</span>)</div>
<div class="line">    </div>
<div class="line">    ser = serial.Serial(port, 115200, timeout=1)</div>
<div class="line">    time.sleep(2)</div>
<div class="line">    </div>
<div class="line">    <span class="comment"># Ensure FLIGHT mode</span></div>
<div class="line">    ser.write(b<span class="stringliteral">&quot;mode flight\r\n&quot;</span>)</div>
<div class="line">    time.sleep(1)</div>
<div class="line">    </div>
<div class="line">    start_time = time.time()</div>
<div class="line">    iterations = 0</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">while</span> time.time() - start_time &lt; duration_sec:</div>
<div class="line">        <span class="comment"># Random sequence of commands</span></div>
<div class="line">        commands = [<span class="stringliteral">&quot;arm&quot;</span>, <span class="stringliteral">&quot;disarm&quot;</span>, <span class="stringliteral">&quot;status&quot;</span>, <span class="stringliteral">&quot;health&quot;</span>, <span class="stringliteral">&quot;sensor all&quot;</span>]</div>
<div class="line">        cmd = random.choice(commands)</div>
<div class="line">        </div>
<div class="line">        ser.reset_input_buffer()</div>
<div class="line">        ser.write(f<span class="stringliteral">&quot;{cmd}\r\n&quot;</span>.encode())</div>
<div class="line">        time.sleep(0.2)</div>
<div class="line">        </div>
<div class="line">        <span class="comment"># Read response</span></div>
<div class="line">        <span class="keywordflow">if</span> ser.in_waiting:</div>
<div class="line">            response = ser.read(ser.in_waiting).decode(<span class="stringliteral">&#39;utf-8&#39;</span>, errors=<span class="stringliteral">&#39;ignore&#39;</span>)</div>
<div class="line">            <span class="comment"># Check for any error messages</span></div>
<div class="line">            <span class="keywordflow">if</span> <span class="stringliteral">&quot;error&quot;</span> <span class="keywordflow">in</span> response.lower() <span class="keywordflow">or</span> <span class="stringliteral">&quot;fault&quot;</span> <span class="keywordflow">in</span> response.lower():</div>
<div class="line">                print(f<span class="stringliteral">&quot;Iteration {iterations}: {cmd} -&gt; {response}&quot;</span>)</div>
<div class="line">        </div>
<div class="line">        iterations += 1</div>
<div class="line">        </div>
<div class="line">        <span class="comment"># Brief pause between commands</span></div>
<div class="line">        time.sleep(random.uniform(0.1, 0.5))</div>
<div class="line">    </div>
<div class="line">    ser.close()</div>
<div class="line">    print(f<span class="stringliteral">&quot;Completed {iterations} iterations in {duration_sec}s&quot;</span>)</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line">    <span class="keywordflow">if</span> len(sys.argv) &lt; 2:</div>
<div class="line">        print(<span class="stringliteral">&quot;Usage: python3 safety_stress_test.py &lt;serial_port&gt; [duration_sec]&quot;</span>)</div>
<div class="line">        sys.exit(1)</div>
<div class="line">    </div>
<div class="line">    port = sys.argv[1]</div>
<div class="line">    duration = int(sys.argv[2]) <span class="keywordflow">if</span> len(sys.argv) &gt; 2 <span class="keywordflow">else</span> 60</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">try</span>:</div>
<div class="line">        stress_test_safety_gates(port, duration)</div>
<div class="line">        print(<span class="stringliteral">&quot;âœ“ Stress test completed successfully&quot;</span>)</div>
<div class="line">    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">        print(f<span class="stringliteral">&quot;Stress test error: {e}&quot;</span>)</div>
<div class="line">        sys.exit(1)</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md8953"></a>
Test Execution Checklist</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8954"></a>
Manual Testing</h2>
<ul class="check">
<li class="unchecked">Scenario 1: Basic arming flow completed</li>
</ul>
<ul class="check">
<li class="unchecked">Scenario 2: Sensor health blocking tested</li>
</ul>
<ul class="check">
<li class="unchecked">Scenario 3: Link quality validation tested</li>
</ul>
<ul class="check">
<li class="unchecked">Scenario 4: CPU budget enforcement tested</li>
</ul>
<ul class="check">
<li class="unchecked">Scenario 5: Vehicle launch envelope tested</li>
</ul>
<ul class="check">
<li class="unchecked">Scenario 6: Failsafe link loss tested</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8955"></a>
Automated Testing</h2>
<ul class="check">
<li class="unchecked">Basic arming flow script executed</li>
</ul>
<ul class="check">
<li class="unchecked">Sensor health blocking script executed <br  />
</li>
</ul>
<ul class="check">
<li class="unchecked">Safety gate stress test executed (60s minimum)</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8956"></a>
Regression Testing</h2>
<ul class="check">
<li class="unchecked">All CLI commands respond correctly</li>
</ul>
<ul class="check">
<li class="unchecked">No unexpected system resets or crashes</li>
</ul>
<ul class="check">
<li class="unchecked">Safety gates properly enforce all conditions</li>
</ul>
<ul class="check">
<li class="unchecked">Failsafe behavior consistent and predictable</li>
</ul>
<ul class="check">
<li class="unchecked">System recovers cleanly from fault conditions</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md8957"></a>
Expected Performance Benchmarks</h1>
<ul>
<li><b>Arming Response Time</b>: &lt; 100ms from command to state change</li>
<li><b>Failsafe Trigger Time</b>: â‰¤ 1000ms from link loss to disarm</li>
<li><b>Safety Gate Evaluation</b>: &lt; 50ms per preflight check</li>
<li><b>CLI Command Response</b>: &lt; 200ms for status queries</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md8958"></a>
Troubleshooting Guide</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md8959"></a>
Common Issues</h2>
<p><b>Arming Always Blocked</b></p>
<ul>
<li>Check mode: must be in FLIGHT mode</li>
<li>Verify sensor health: <span class="tt">sensor all</span></li>
<li>Check preflight status: <span class="tt">health</span></li>
</ul>
<p><b>Inconsistent Behavior</b></p>
<ul>
<li>Reset system: <span class="tt">reboot</span></li>
<li>Check for memory corruption</li>
<li>Verify sensor connections</li>
</ul>
<p><b>Failsafe Not Triggering</b></p>
<ul>
<li>Confirm link simulation commands available</li>
<li>Check failsafe configuration</li>
<li>Verify system time sources</li>
</ul>
<p>This integration test suite validates the complete Phase 4 safety system implementation through realistic operator scenarios and automated stress testing. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on <span class="timestamp"></span> for ACP - Autonomous Command Protocol by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
