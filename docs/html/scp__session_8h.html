<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ACP - Autonomous Command Protocol: /Users/paulzanna/Github/Scout/include/scp_session.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ACP - Autonomous Command Protocol<span id="projectnumber">&#160;v0.3.0</span>
   </div>
   <div id="projectbrief">Portable C99 framing library with COBS, CRC16, and HMAC-SHA256 authentication</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('scp__session_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">scp_session.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>SCP Session Management and Role-Based Authorization.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &quot;<a class="el" href="scp__protocol_8h_source.html">scp_protocol.h</a>&quot;</code><br />
</div>
<p><a href="scp__session_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:scp_5Frate_5Flimit_5Ft" id="r_scp_5Frate_5Flimit_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscp__rate__limit__t.html">scp_rate_limit_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rate Limiting State for Session.  <a href="structscp__rate__limit__t.html#details">More...</a><br /></td></tr>
<tr class="memitem:scp_5Fsession_5Ft" id="r_scp_5Fsession_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscp__session__t.html">scp_session_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SCP Session State.  <a href="structscp__session__t.html#details">More...</a><br /></td></tr>
<tr class="memitem:scp_5Fsession_5Fmanager_5Ft" id="r_scp_5Fsession_5Fmanager_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscp__session__manager__t.html">scp_session_manager_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Session Manager Global State.  <a href="structscp__session__manager__t.html#details">More...</a><br /></td></tr>
<tr class="memitem:scp_5Fsession_5Fstats_5Ft" id="r_scp_5Fsession_5Fstats_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscp__session__stats__t.html">scp_session_stats_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Session Statistics Structure.  <a href="structscp__session__stats__t.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4778b0edd77da398bde92d1e0b66a712" id="r_a4778b0edd77da398bde92d1e0b66a712"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4778b0edd77da398bde92d1e0b66a712">SCP_MAX_SESSIONS</a>&#160;&#160;&#160;3</td></tr>
<tr class="memitem:a491209968547e1da6401059e229dbc32" id="r_a491209968547e1da6401059e229dbc32"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a491209968547e1da6401059e229dbc32">SCP_SESSION_KEY_SIZE</a>&#160;&#160;&#160;32</td></tr>
<tr class="memitem:a86923a494f5d7835b7a17f139401d570" id="r_a86923a494f5d7835b7a17f139401d570"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a86923a494f5d7835b7a17f139401d570">SCP_SESSION_ID_INVALID</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:aae79f7c35206a92b700f9d72ea0cfacb" id="r_aae79f7c35206a92b700f9d72ea0cfacb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae79f7c35206a92b700f9d72ea0cfacb">SCP_SEQ_NUM_MAX</a>&#160;&#160;&#160;255</td></tr>
<tr class="memitem:ae1f8632ccfddc67335405c0bd14647d9" id="r_ae1f8632ccfddc67335405c0bd14647d9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae1f8632ccfddc67335405c0bd14647d9">SCP_SESSION_STATE_INACTIVE</a>&#160;&#160;&#160;0</td></tr>
<tr class="memitem:aad0631409d2d7044755b76f7e933b3a9" id="r_aad0631409d2d7044755b76f7e933b3a9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad0631409d2d7044755b76f7e933b3a9">SCP_SESSION_STATE_PENDING</a>&#160;&#160;&#160;1</td></tr>
<tr class="memitem:a0ecbb8f9a27ef8e794821c76edf9c1e8" id="r_a0ecbb8f9a27ef8e794821c76edf9c1e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ecbb8f9a27ef8e794821c76edf9c1e8">SCP_SESSION_STATE_ACTIVE</a>&#160;&#160;&#160;2</td></tr>
<tr class="memitem:a25b680016d29d3c227ed4de52b53d73b" id="r_a25b680016d29d3c227ed4de52b53d73b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a25b680016d29d3c227ed4de52b53d73b">SCP_SESSION_STATE_SUSPENDED</a>&#160;&#160;&#160;3</td></tr>
<tr class="memitem:a5dd53c7ce338a0eb4e81f01a37b29fe2" id="r_a5dd53c7ce338a0eb4e81f01a37b29fe2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5dd53c7ce338a0eb4e81f01a37b29fe2">SCP_SESSION_STATE_EXPIRED</a>&#160;&#160;&#160;4</td></tr>
<tr class="memitem:a57884a219dfd12734c581e79b015adf9" id="r_a57884a219dfd12734c581e79b015adf9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57884a219dfd12734c581e79b015adf9">last_sequence_num</a>&#160;&#160;&#160;last_seq_num</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-typedef-members" class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ad9a93cf0557f329b36d0d5bcb907ab25" id="r_ad9a93cf0557f329b36d0d5bcb907ab25"><td class="memItemLeft" align="right" valign="top">typedef int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad9a93cf0557f329b36d0d5bcb907ab25">scp_crypto_result_t</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad3d73f3299f0defd0e1b1d8c27d85bb9" id="r_ad3d73f3299f0defd0e1b1d8c27d85bb9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3d73f3299f0defd0e1b1d8c27d85bb9">scp_session_init</a> (void)</td></tr>
<tr class="memdesc:ad3d73f3299f0defd0e1b1d8c27d85bb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Session Manager.  <br /></td></tr>
<tr class="memitem:ac083bcf42c885861652d55a34726c689" id="r_ac083bcf42c885861652d55a34726c689"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac083bcf42c885861652d55a34726c689">scp_session_create</a> (uint8_t operator_role, uint8_t connection_type, const uint8_t *auth_key, uint32_t *session_id_out)</td></tr>
<tr class="memdesc:ac083bcf42c885861652d55a34726c689"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create New Session.  <br /></td></tr>
<tr class="memitem:ad039d5c00510137f0d45adcb94b89714" id="r_ad039d5c00510137f0d45adcb94b89714"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad039d5c00510137f0d45adcb94b89714">scp_session_authenticate</a> (uint32_t session_id, uint8_t seq_num, const uint8_t *auth_tag, const uint8_t *message_data, uint16_t message_len)</td></tr>
<tr class="memdesc:ad039d5c00510137f0d45adcb94b89714"><td class="mdescLeft">&#160;</td><td class="mdescRight">Authenticate Session Message.  <br /></td></tr>
<tr class="memitem:a9c2284c7ec0dfc4c67e77ff6d228f10d" id="r_a9c2284c7ec0dfc4c67e77ff6d228f10d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9c2284c7ec0dfc4c67e77ff6d228f10d">scp_session_check_rate_limit</a> (uint32_t session_id, uint32_t current_time_ms)</td></tr>
<tr class="memdesc:a9c2284c7ec0dfc4c67e77ff6d228f10d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check Rate Limiting.  <br /></td></tr>
<tr class="memitem:a3590ad447faa01be4c8d3938d71f1713" id="r_a3590ad447faa01be4c8d3938d71f1713"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3590ad447faa01be4c8d3938d71f1713">scp_session_authorize_command</a> (uint32_t session_id, uint8_t msg_type, const void *command_data)</td></tr>
<tr class="memdesc:a3590ad447faa01be4c8d3938d71f1713"><td class="mdescLeft">&#160;</td><td class="mdescRight">Authorize Command.  <br /></td></tr>
<tr class="memitem:ac66643c8694a2ac7f6f5140a3703fe25" id="r_ac66643c8694a2ac7f6f5140a3703fe25"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac66643c8694a2ac7f6f5140a3703fe25">scp_session_update_activity</a> (uint32_t session_id, uint32_t current_time_ms)</td></tr>
<tr class="memdesc:ac66643c8694a2ac7f6f5140a3703fe25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update Session Activity.  <br /></td></tr>
<tr class="memitem:a6948e297cd6a0ece2120ff4f5b28321d" id="r_a6948e297cd6a0ece2120ff4f5b28321d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6948e297cd6a0ece2120ff4f5b28321d">scp_session_close</a> (uint32_t session_id)</td></tr>
<tr class="memdesc:a6948e297cd6a0ece2120ff4f5b28321d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close Session.  <br /></td></tr>
<tr class="memitem:a0f24bc93e5113e27a667ec47588bef69" id="r_a0f24bc93e5113e27a667ec47588bef69"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0f24bc93e5113e27a667ec47588bef69">scp_session_cleanup_expired</a> (uint32_t current_time_ms)</td></tr>
<tr class="memdesc:a0f24bc93e5113e27a667ec47588bef69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleanup Expired Sessions.  <br /></td></tr>
<tr class="memitem:a094b5b42684a44155ea8cfb25ce0dcfd" id="r_a094b5b42684a44155ea8cfb25ce0dcfd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structscp__session__t.html">scp_session_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a094b5b42684a44155ea8cfb25ce0dcfd">scp_session_get_by_id</a> (uint32_t session_id)</td></tr>
<tr class="memdesc:a094b5b42684a44155ea8cfb25ce0dcfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Session by ID.  <br /></td></tr>
<tr class="memitem:a90fbea596ac51eb5a544f49e638f0485" id="r_a90fbea596ac51eb5a544f49e638f0485"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90fbea596ac51eb5a544f49e638f0485">scp_session_get_active_count</a> (void)</td></tr>
<tr class="memdesc:a90fbea596ac51eb5a544f49e638f0485"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Active Session Count.  <br /></td></tr>
<tr class="memitem:aaa6ff0b204c64beba095bcec7203a5f1" id="r_aaa6ff0b204c64beba095bcec7203a5f1"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa6ff0b204c64beba095bcec7203a5f1">scp_session_get_list</a> (<a class="el" href="structscp__session__t.html">scp_session_t</a> *sessions_out, uint8_t max_sessions)</td></tr>
<tr class="memdesc:aaa6ff0b204c64beba095bcec7203a5f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Session List.  <br /></td></tr>
<tr class="memitem:adfc2746846e2cb4451623da6af2a74da" id="r_adfc2746846e2cb4451623da6af2a74da"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adfc2746846e2cb4451623da6af2a74da">scp_session_get_priority</a> (uint32_t session_id, uint8_t msg_type)</td></tr>
<tr class="memdesc:adfc2746846e2cb4451623da6af2a74da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check Session Priority.  <br /></td></tr>
<tr class="memitem:a0644bce1e2458e854761291ae60444cd" id="r_a0644bce1e2458e854761291ae60444cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0644bce1e2458e854761291ae60444cd">scp_session_get_stats</a> (<a class="el" href="structscp__session__stats__t.html">scp_session_stats_t</a> *stats_out)</td></tr>
<tr class="memdesc:a0644bce1e2458e854761291ae60444cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Session Statistics.  <br /></td></tr>
<tr class="memitem:a9660f1987e5d43f6c06f628350195e3c" id="r_a9660f1987e5d43f6c06f628350195e3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9660f1987e5d43f6c06f628350195e3c">scp_session_reset_stats</a> (void)</td></tr>
<tr class="memdesc:a9660f1987e5d43f6c06f628350195e3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset Session Statistics.  <br /></td></tr>
<tr class="memitem:a13a8571d38e8de43f61348aa0cc731f8" id="r_a13a8571d38e8de43f61348aa0cc731f8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a13a8571d38e8de43f61348aa0cc731f8">scp_role_can_execute</a> (uint8_t role, uint8_t msg_type)</td></tr>
<tr class="memdesc:a13a8571d38e8de43f61348aa0cc731f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if role can execute command type.  <br /></td></tr>
<tr class="memitem:a130cf94874c6309289f4a2f479b5b5b9" id="r_a130cf94874c6309289f4a2f479b5b5b9"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a130cf94874c6309289f4a2f479b5b5b9">scp_role_get_name</a> (uint8_t role)</td></tr>
<tr class="memdesc:a130cf94874c6309289f4a2f479b5b5b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get role name string.  <br /></td></tr>
<tr class="memitem:a3abc6b61bb4d442ccf042c24e6c9b898" id="r_a3abc6b61bb4d442ccf042c24e6c9b898"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3abc6b61bb4d442ccf042c24e6c9b898">scp_connection_get_name</a> (uint8_t conn_type)</td></tr>
<tr class="memdesc:a3abc6b61bb4d442ccf042c24e6c9b898"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get connection type name string.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SCP Session Management and Role-Based Authorization. </p>
<p>Manages operator sessions with role-based access control, rate limiting, and cryptographic authentication for the Secure Control Protocol (SCP) v1.1.</p>
<dl class="section author"><dt>Author</dt><dd>Scout ISR Project </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2025-10-26 </dd></dl>

<p class="definition">Definition in file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>
</div><a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="a57884a219dfd12734c581e79b015adf9" name="a57884a219dfd12734c581e79b015adf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57884a219dfd12734c581e79b015adf9">&#9670;&#160;</a></span>last_sequence_num</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define last_sequence_num&#160;&#160;&#160;last_seq_num</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scp__session_8h_source.html#l00101">101</a> of file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>

</div>
</div>
<a id="a4778b0edd77da398bde92d1e0b66a712" name="a4778b0edd77da398bde92d1e0b66a712"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4778b0edd77da398bde92d1e0b66a712">&#9670;&#160;</a></span>SCP_MAX_SESSIONS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCP_MAX_SESSIONS&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scp__session_8h_source.html#l00029">29</a> of file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>

</div>
</div>
<a id="aae79f7c35206a92b700f9d72ea0cfacb" name="aae79f7c35206a92b700f9d72ea0cfacb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae79f7c35206a92b700f9d72ea0cfacb">&#9670;&#160;</a></span>SCP_SEQ_NUM_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCP_SEQ_NUM_MAX&#160;&#160;&#160;255</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scp__session_8h_source.html#l00032">32</a> of file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>

</div>
</div>
<a id="a86923a494f5d7835b7a17f139401d570" name="a86923a494f5d7835b7a17f139401d570"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86923a494f5d7835b7a17f139401d570">&#9670;&#160;</a></span>SCP_SESSION_ID_INVALID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCP_SESSION_ID_INVALID&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scp__session_8h_source.html#l00031">31</a> of file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>

</div>
</div>
<a id="a491209968547e1da6401059e229dbc32" name="a491209968547e1da6401059e229dbc32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a491209968547e1da6401059e229dbc32">&#9670;&#160;</a></span>SCP_SESSION_KEY_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCP_SESSION_KEY_SIZE&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scp__session_8h_source.html#l00030">30</a> of file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>

</div>
</div>
<a id="a0ecbb8f9a27ef8e794821c76edf9c1e8" name="a0ecbb8f9a27ef8e794821c76edf9c1e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ecbb8f9a27ef8e794821c76edf9c1e8">&#9670;&#160;</a></span>SCP_SESSION_STATE_ACTIVE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCP_SESSION_STATE_ACTIVE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scp__session_8h_source.html#l00040">40</a> of file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>

</div>
</div>
<a id="a5dd53c7ce338a0eb4e81f01a37b29fe2" name="a5dd53c7ce338a0eb4e81f01a37b29fe2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dd53c7ce338a0eb4e81f01a37b29fe2">&#9670;&#160;</a></span>SCP_SESSION_STATE_EXPIRED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCP_SESSION_STATE_EXPIRED&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scp__session_8h_source.html#l00042">42</a> of file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>

</div>
</div>
<a id="ae1f8632ccfddc67335405c0bd14647d9" name="ae1f8632ccfddc67335405c0bd14647d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1f8632ccfddc67335405c0bd14647d9">&#9670;&#160;</a></span>SCP_SESSION_STATE_INACTIVE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCP_SESSION_STATE_INACTIVE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scp__session_8h_source.html#l00038">38</a> of file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>

</div>
</div>
<a id="aad0631409d2d7044755b76f7e933b3a9" name="aad0631409d2d7044755b76f7e933b3a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad0631409d2d7044755b76f7e933b3a9">&#9670;&#160;</a></span>SCP_SESSION_STATE_PENDING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCP_SESSION_STATE_PENDING&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scp__session_8h_source.html#l00039">39</a> of file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>

</div>
</div>
<a id="a25b680016d29d3c227ed4de52b53d73b" name="a25b680016d29d3c227ed4de52b53d73b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25b680016d29d3c227ed4de52b53d73b">&#9670;&#160;</a></span>SCP_SESSION_STATE_SUSPENDED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCP_SESSION_STATE_SUSPENDED&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scp__session_8h_source.html#l00041">41</a> of file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>

</div>
</div>
<a name="doc-typedef-members" id="doc-typedef-members"></a><h2 id="header-doc-typedef-members" class="groupheader">Typedef Documentation</h2>
<a id="ad9a93cf0557f329b36d0d5bcb907ab25" name="ad9a93cf0557f329b36d0d5bcb907ab25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9a93cf0557f329b36d0d5bcb907ab25">&#9670;&#160;</a></span>scp_crypto_result_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int scp_crypto_result_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scp__session_8h_source.html#l00035">35</a> of file <a class="el" href="scp__session_8h_source.html">scp_session.h</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a3abc6b61bb4d442ccf042c24e6c9b898" name="a3abc6b61bb4d442ccf042c24e6c9b898"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3abc6b61bb4d442ccf042c24e6c9b898">&#9670;&#160;</a></span>scp_connection_get_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * scp_connection_get_name </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>conn_type</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get connection type name string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn_type</td><td>Connection type (SCP_CONN_*) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Connection type name for logging/display </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00297">297</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cmd__scp__config_8c_source.html#l00046">cmd_scp_sessions()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00545">gcs_gateway_log_security_violation()</a>, <a class="el" href="scp__session_8c_source.html#l00354">scp_session_create()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00093">test_session_creation_variants()</a>.</p>

</div>
</div>
<a id="a13a8571d38e8de43f61348aa0cc731f8" name="a13a8571d38e8de43f61348aa0cc731f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13a8571d38e8de43f61348aa0cc731f8">&#9670;&#160;</a></span>scp_role_can_execute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool scp_role_can_execute </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>role</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>msg_type</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if role can execute command type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">role</td><td>Operator role (SCP_ROLE_*) </td></tr>
    <tr><td class="paramname">msg_type</td><td>Message type (SCP_CMD_*) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if role authorized for message type </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00244">244</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00635">gcs_gateway_process_arm_command()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00715">gcs_gateway_process_disarm_command()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00768">gcs_gateway_process_mode_change()</a>, <a class="el" href="scp__session_8c_source.html#l00538">scp_session_authorize_command()</a>, <a class="el" href="test__scp__session_8c_source.html#l00263">test_role_based_authorization()</a>, and <a class="el" href="security__test_8c_source.html#l00304">test_security_role_authorization_matrix()</a>.</p>

</div>
</div>
<a id="a130cf94874c6309289f4a2f479b5b5b9" name="a130cf94874c6309289f4a2f479b5b5b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a130cf94874c6309289f4a2f479b5b5b9">&#9670;&#160;</a></span>scp_role_get_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * scp_role_get_name </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>role</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get role name string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">role</td><td>Operator role (SCP_ROLE_*) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Role name string for logging/display </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00282">282</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cmd__scp__config_8c_source.html#l00046">cmd_scp_sessions()</a>, <a class="el" href="cmd__scp__config_8c_source.html#l00315">cmd_scp_telemetry()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00545">gcs_gateway_log_security_violation()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00480">gcs_gateway_log_to_audit_system()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00635">gcs_gateway_process_arm_command()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00715">gcs_gateway_process_disarm_command()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00768">gcs_gateway_process_mode_change()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01619">gcs_gateway_send_tlm_status_targeted()</a>, <a class="el" href="scp__session_8c_source.html#l00538">scp_session_authorize_command()</a>, <a class="el" href="scp__session_8c_source.html#l00601">scp_session_close()</a>, <a class="el" href="scp__session_8c_source.html#l00354">scp_session_create()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00093">test_session_creation_variants()</a>.</p>

</div>
</div>
<a id="ad039d5c00510137f0d45adcb94b89714" name="ad039d5c00510137f0d45adcb94b89714"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad039d5c00510137f0d45adcb94b89714">&#9670;&#160;</a></span>scp_session_authenticate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool scp_session_authenticate </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>seq_num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>auth_tag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>message_data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>message_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Authenticate Session Message. </p>
<p>Validates message authentication and sequence number for an active session. Updates session activity timestamp and sequence tracking.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session identifier </td></tr>
    <tr><td class="paramname">seq_num</td><td>Message sequence number </td></tr>
    <tr><td class="paramname">auth_tag</td><td>HMAC authentication tag (16 bytes, or NULL if no auth) </td></tr>
    <tr><td class="paramname">message_data</td><td>Message data for HMAC verification </td></tr>
    <tr><td class="paramname">message_len</td><td>Message data length </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if authentication successful, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00440">440</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00054">find_session_by_id()</a>, <a class="el" href="scp__session_8c_source.html#l00046">get_current_time_ms()</a>, <a class="el" href="scp__session_8c_source.html#l00132">is_sequence_valid()</a>, and <a class="el" href="scp__crypto_8c_source.html#l00217">scp_crypto_hmac_verify()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cmd__scp__config_8c_source.html#l00562">cmd_scp_selftest()</a>, <a class="el" href="security__test_8c_source.html#l00203">test_security_hmac_tampering_detection()</a>, <a class="el" href="security__test_8c_source.html#l00171">test_security_invalid_hmac_rejection()</a>, <a class="el" href="security__test_8c_source.html#l00894">test_security_monitoring_cli_integration()</a>, <a class="el" href="security__test_8c_source.html#l00236">test_security_replay_attack_detection()</a>, <a class="el" href="security__test_8c_source.html#l00275">test_security_sequence_number_rollover()</a>, <a class="el" href="security__test_8c_source.html#l00453">test_security_session_isolation()</a>, <a class="el" href="security__test_8c_source.html#l00124">test_security_valid_hmac_authentication()</a>, <a class="el" href="security__test_8c_source.html#l00670">test_security_violation_detection_and_reporting()</a>, <a class="el" href="test__scp__session_8c_source.html#l00218">test_session_authentication_failures()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00185">test_session_authentication_valid()</a>.</p>

</div>
</div>
<a id="a3590ad447faa01be4c8d3938d71f1713" name="a3590ad447faa01be4c8d3938d71f1713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3590ad447faa01be4c8d3938d71f1713">&#9670;&#160;</a></span>scp_session_authorize_command()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool scp_session_authorize_command </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>msg_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>command_data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Authorize Command. </p>
<p>Checks if session has sufficient role privileges to execute the specified command.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session identifier </td></tr>
    <tr><td class="paramname">msg_type</td><td>Message type (SCP_CMD_*) </td></tr>
    <tr><td class="paramname">command_data</td><td>Command-specific data for additional authorization checks </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if authorized, false if insufficient privileges </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00538">538</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00054">find_session_by_id()</a>, <a class="el" href="scp__session_8c_source.html#l00244">scp_role_can_execute()</a>, and <a class="el" href="scp__session_8c_source.html#l00282">scp_role_get_name()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00836">gcs_gateway_process_cmd_control()</a>, <a class="el" href="security__test_8c_source.html#l00325">test_security_session_authorization_enforcement()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00287">test_session_command_authorization()</a>.</p>

</div>
</div>
<a id="a9c2284c7ec0dfc4c67e77ff6d228f10d" name="a9c2284c7ec0dfc4c67e77ff6d228f10d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c2284c7ec0dfc4c67e77ff6d228f10d">&#9670;&#160;</a></span>scp_session_check_rate_limit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool scp_session_check_rate_limit </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>current_time_ms</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check Rate Limiting. </p>
<p>Verifies if session can send another command based on rate limiting rules. Updates rate limiting state if command is allowed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session identifier </td></tr>
    <tr><td class="paramname">current_time_ms</td><td>Current system time (milliseconds) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if command allowed, false if rate limited </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00514">514</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00054">find_session_by_id()</a>, and <a class="el" href="scp__session_8c_source.html#l00178">update_rate_limit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00444">gcs_gateway_check_enhanced_rate_limit()</a>, <a class="el" href="test__scp__session_8c_source.html#l00323">test_rate_limiting_basic()</a>, <a class="el" href="test__scp__session_8c_source.html#l00354">test_rate_limiting_burst()</a>, <a class="el" href="test__scp__session_8c_source.html#l00383">test_rate_limiting_invalid_session()</a>, <a class="el" href="security__test_8c_source.html#l00766">test_rate_limiting_security_violation_escalation()</a>, <a class="el" href="security__test_8c_source.html#l00894">test_security_monitoring_cli_integration()</a>, <a class="el" href="security__test_8c_source.html#l00422">test_security_rate_limit_window_reset()</a>, and <a class="el" href="security__test_8c_source.html#l00391">test_security_rate_limiting_enforcement()</a>.</p>

</div>
</div>
<a id="a0f24bc93e5113e27a667ec47588bef69" name="a0f24bc93e5113e27a667ec47588bef69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f24bc93e5113e27a667ec47588bef69">&#9670;&#160;</a></span>scp_session_cleanup_expired()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t scp_session_cleanup_expired </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>current_time_ms</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cleanup Expired Sessions. </p>
<p>Removes sessions that have exceeded their timeout period. Should be called periodically by the main protocol task.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_time_ms</td><td>Current system time (milliseconds) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of sessions cleaned up </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00659">659</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00601">scp_session_close()</a>, and <a class="el" href="scp__session_8c_source.html#l00032">session_manager</a>.</p>

<p class="reference">Referenced by <a class="el" href="security__test_8c_source.html#l00480">test_security_session_timeout()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00426">test_session_timeout()</a>.</p>

</div>
</div>
<a id="a6948e297cd6a0ece2120ff4f5b28321d" name="a6948e297cd6a0ece2120ff4f5b28321d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6948e297cd6a0ece2120ff4f5b28321d">&#9670;&#160;</a></span>scp_session_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool scp_session_close </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close Session. </p>
<p>Terminates and cleans up the specified session.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session identifier </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if session found and closed, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00601">601</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00054">find_session_by_id()</a>, <a class="el" href="scp__crypto_8c_source.html#l00062">scp_crypto_secure_memclear()</a>, <a class="el" href="scp__session_8c_source.html#l00282">scp_role_get_name()</a>, and <a class="el" href="scp__session_8c_source.html#l00032">session_manager</a>.</p>

<p class="reference">Referenced by <a class="el" href="cmd__scp__config_8c_source.html#l00525">cmd_scp_reset()</a>, <a class="el" href="scp__session_8c_source.html#l00659">scp_session_cleanup_expired()</a>, <a class="el" href="scp__protocol__test_8c_source.html#l00404">test_integration_role_based_authorization()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00399">test_session_closure()</a>.</p>

</div>
</div>
<a id="ac083bcf42c885861652d55a34726c689" name="ac083bcf42c885861652d55a34726c689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac083bcf42c885861652d55a34726c689">&#9670;&#160;</a></span>scp_session_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool scp_session_create </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>operator_role</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>connection_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>auth_key</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>session_id_out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create New Session. </p>
<p>Creates a new authenticated session for the specified operator role and connection type.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operator_role</td><td>Role: SCP_ROLE_COMMANDER/PILOT/OBSERVER </td></tr>
    <tr><td class="paramname">connection_type</td><td>Transport: SCP_CONN_UART/USB/SPI </td></tr>
    <tr><td class="paramname">auth_key</td><td>Authentication key (32 bytes) </td></tr>
    <tr><td class="paramname">session_id_out</td><td>Output: allocated session ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if session created successfully, false if no slots available </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00354">354</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00076">find_free_session_slot()</a>, <a class="el" href="scp__session_8c_source.html#l00046">get_current_time_ms()</a>, <a class="el" href="scp__session_8c_source.html#l00091">init_session()</a>, <a class="el" href="scp__session_8c_source.html#l00297">scp_connection_get_name()</a>, <a class="el" href="scp__session_8c_source.html#l00282">scp_role_get_name()</a>, and <a class="el" href="scp__session_8c_source.html#l00032">session_manager</a>.</p>

<p class="reference">Referenced by <a class="el" href="cmd__scp__config_8c_source.html#l00562">cmd_scp_selftest()</a>, <a class="el" href="scp__protocol__test_8c_source.html#l00404">test_integration_role_based_authorization()</a>, <a class="el" href="test__scp__session_8c_source.html#l00323">test_rate_limiting_basic()</a>, <a class="el" href="test__scp__session_8c_source.html#l00354">test_rate_limiting_burst()</a>, <a class="el" href="test__scp__session_8c_source.html#l00218">test_session_authentication_failures()</a>, <a class="el" href="test__scp__session_8c_source.html#l00185">test_session_authentication_valid()</a>, <a class="el" href="test__scp__session_8c_source.html#l00399">test_session_closure()</a>, <a class="el" href="test__scp__session_8c_source.html#l00287">test_session_command_authorization()</a>, <a class="el" href="test__scp__session_8c_source.html#l00070">test_session_creation_basic()</a>, <a class="el" href="test__scp__session_8c_source.html#l00130">test_session_creation_errors()</a>, <a class="el" href="test__scp__session_8c_source.html#l00152">test_session_creation_limit()</a>, <a class="el" href="test__scp__session_8c_source.html#l00093">test_session_creation_variants()</a>, <a class="el" href="test__scp__session_8c_source.html#l00459">test_session_list()</a>, <a class="el" href="test__scp__session_8c_source.html#l00499">test_session_priority()</a>, <a class="el" href="test__scp__session_8c_source.html#l00535">test_session_statistics()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00426">test_session_timeout()</a>.</p>

</div>
</div>
<a id="a90fbea596ac51eb5a544f49e638f0485" name="a90fbea596ac51eb5a544f49e638f0485"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90fbea596ac51eb5a544f49e638f0485">&#9670;&#160;</a></span>scp_session_get_active_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t scp_session_get_active_count </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get Active Session Count. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of currently active sessions </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00720">720</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00032">session_manager</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__scp__session_8c_source.html#l00399">test_session_closure()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00152">test_session_creation_limit()</a>.</p>

</div>
</div>
<a id="a094b5b42684a44155ea8cfb25ce0dcfd" name="a094b5b42684a44155ea8cfb25ce0dcfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a094b5b42684a44155ea8cfb25ce0dcfd">&#9670;&#160;</a></span>scp_session_get_by_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscp__session__t.html">scp_session_t</a> * scp_session_get_by_id </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get Session by ID. </p>
<p>Retrieves session information for the specified session ID.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session identifier </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to session structure, or NULL if not found </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00709">709</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00054">find_session_by_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00314">gcs_gateway_audit_auth_failure()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00280">gcs_gateway_audit_command_attempt()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00369">gcs_gateway_audit_security_violation()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00545">gcs_gateway_log_security_violation()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00480">gcs_gateway_log_to_audit_system()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00836">gcs_gateway_process_cmd_control()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00136">gcs_gateway_send_response()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01833">gcs_gateway_set_session_telemetry()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00404">gcs_gateway_validate_sequence()</a>, <a class="el" href="security__test_8c_source.html#l00480">test_security_session_timeout()</a>, <a class="el" href="test__scp__session_8c_source.html#l00185">test_session_authentication_valid()</a>, <a class="el" href="test__scp__session_8c_source.html#l00399">test_session_closure()</a>, <a class="el" href="test__scp__session_8c_source.html#l00070">test_session_creation_basic()</a>, <a class="el" href="test__scp__session_8c_source.html#l00093">test_session_creation_variants()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00426">test_session_timeout()</a>.</p>

</div>
</div>
<a id="aaa6ff0b204c64beba095bcec7203a5f1" name="aaa6ff0b204c64beba095bcec7203a5f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa6ff0b204c64beba095bcec7203a5f1">&#9670;&#160;</a></span>scp_session_get_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t scp_session_get_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscp__session__t.html">scp_session_t</a> *</td>          <td class="paramname"><span class="paramname"><em>sessions_out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>max_sessions</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get Session List. </p>
<p>Retrieves list of all active sessions for monitoring and debugging.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sessions_out</td><td>Output buffer for session information </td></tr>
    <tr><td class="paramname">max_sessions</td><td>Maximum number of sessions to return </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Actual number of sessions returned </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00730">730</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00032">session_manager</a>.</p>

<p class="reference">Referenced by <a class="el" href="cmd__scp__config_8c_source.html#l00525">cmd_scp_reset()</a>, <a class="el" href="cmd__scp__config_8c_source.html#l00046">cmd_scp_sessions()</a>, <a class="el" href="cmd__scp__config_8c_source.html#l00315">cmd_scp_telemetry()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01880">gcs_gateway_get_session_telemetry_stats()</a>, <a class="el" href="gcs__gateway__runtime_8c_source.html#l00374">gcs_gateway_send_audit()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00197">gcs_gateway_send_audit_event()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01619">gcs_gateway_send_tlm_status_targeted()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01833">gcs_gateway_set_session_telemetry()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00459">test_session_list()</a>.</p>

</div>
</div>
<a id="adfc2746846e2cb4451623da6af2a74da" name="adfc2746846e2cb4451623da6af2a74da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfc2746846e2cb4451623da6af2a74da">&#9670;&#160;</a></span>scp_session_get_priority()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t scp_session_get_priority </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>msg_type</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check Session Priority. </p>
<p>Determines message priority level based on operator role and message type. Used for priority-based message queuing and processing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session identifier </td></tr>
    <tr><td class="paramname">msg_type</td><td>Message type </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Priority level (SCP_PRIORITY_*) </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00756">756</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00054">find_session_by_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__scp__session_8c_source.html#l00499">test_session_priority()</a>.</p>

</div>
</div>
<a id="a0644bce1e2458e854761291ae60444cd" name="a0644bce1e2458e854761291ae60444cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0644bce1e2458e854761291ae60444cd">&#9670;&#160;</a></span>scp_session_get_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scp_session_get_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscp__session__stats__t.html">scp_session_stats_t</a> *</td>          <td class="paramname"><span class="paramname"><em>stats_out</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get Session Statistics. </p>
<p>Retrieves aggregated session statistics for monitoring.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stats_out</td><td>Output buffer for statistics </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00809">809</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00032">session_manager</a>.</p>

<p class="reference">Referenced by <a class="el" href="cmd__scp__config_8c_source.html#l00153">cmd_scp_security()</a>, <a class="el" href="cmd__scp__config_8c_source.html#l00046">cmd_scp_sessions()</a>, <a class="el" href="security__test_8c_source.html#l00171">test_security_invalid_hmac_rejection()</a>, <a class="el" href="security__test_8c_source.html#l00391">test_security_rate_limiting_enforcement()</a>, <a class="el" href="security__test_8c_source.html#l00124">test_security_valid_hmac_authentication()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00535">test_session_statistics()</a>.</p>

</div>
</div>
<a id="ad3d73f3299f0defd0e1b1d8c27d85bb9" name="ad3d73f3299f0defd0e1b1d8c27d85bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3d73f3299f0defd0e1b1d8c27d85bb9">&#9670;&#160;</a></span>scp_session_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool scp_session_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize Session Manager. </p>
<p>Initializes the session manager and clears all session state. Must be called during system startup.</p>
<dl class="section return"><dt>Returns</dt><dd>true if initialization successful, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00316">316</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00032">session_manager</a>.</p>

<p class="reference">Referenced by <a class="el" href="cmd__scp__config_8c_source.html#l00562">cmd_scp_selftest()</a>.</p>

</div>
</div>
<a id="a9660f1987e5d43f6c06f628350195e3c" name="a9660f1987e5d43f6c06f628350195e3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9660f1987e5d43f6c06f628350195e3c">&#9670;&#160;</a></span>scp_session_reset_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scp_session_reset_stats </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset Session Statistics. </p>
<p>Clears session statistics counters (does not affect active sessions). </p>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00828">828</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="cmd__scp__config_8c_source.html#l00525">cmd_scp_reset()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00535">test_session_statistics()</a>.</p>

</div>
</div>
<a id="ac66643c8694a2ac7f6f5140a3703fe25" name="ac66643c8694a2ac7f6f5140a3703fe25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac66643c8694a2ac7f6f5140a3703fe25">&#9670;&#160;</a></span>scp_session_update_activity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool scp_session_update_activity </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>current_time_ms</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update Session Activity. </p>
<p>Updates session activity timestamp and resets inactivity timeout.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session identifier </td></tr>
    <tr><td class="paramname">current_time_ms</td><td>Current system time (milliseconds) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if session found and updated, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="scp__session_8c_source.html#l00575">575</a> of file <a class="el" href="scp__session_8c_source.html">scp_session.c</a>.</p>

<p class="reference">References <a class="el" href="scp__session_8c_source.html#l00054">find_session_by_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="security__test_8c_source.html#l00480">test_security_session_timeout()</a>, and <a class="el" href="test__scp__session_8c_source.html#l00426">test_session_timeout()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_f76dd88a88a2d119ab336e5933bd9b31.html">Scout</a></li><li class="navelem"><b>include</b></li><li class="navelem"><a href="scp__session_8h.html">scp_session.h</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for ACP - Autonomous Command Protocol by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
