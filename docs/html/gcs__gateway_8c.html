<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ACP - Autonomous Command Protocol: /Users/paulzanna/Github/Scout/src/services/gcs_gateway.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ACP - Autonomous Command Protocol<span id="projectnumber">&#160;v0.3.0</span>
   </div>
   <div id="projectbrief">Portable C99 framing library with COBS, CRC16, and HMAC-SHA256 authentication</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('gcs__gateway_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">gcs_gateway.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>GCS Gateway Service Implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="gcs__gateway_8h_source.html">gcs_gateway.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="scp__protocol_8h_source.html">scp_protocol.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="scp__session_8h_source.html">scp_session.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="scp__framer_8h_source.html">scp_framer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="scp__crypto_8h_source.html">scp_crypto.h</a>&quot;</code><br />
<code>#include &quot;safety_manager.h&quot;</code><br />
<code>#include &quot;mode_manager.h&quot;</code><br />
<code>#include &quot;telemetry_core.h&quot;</code><br />
<code>#include &quot;audit.h&quot;</code><br />
<code>#include &quot;freertos/FreeRTOS.h&quot;</code><br />
<code>#include &quot;freertos/task.h&quot;</code><br />
<code>#include &quot;freertos/queue.h&quot;</code><br />
<code>#include &quot;freertos/semphr.h&quot;</code><br />
<code>#include &quot;esp_log.h&quot;</code><br />
<code>#include &quot;esp_timer.h&quot;</code><br />
<code>#include &quot;blackbox.h&quot;</code><br />
<code>#include &quot;<a class="el" href="mpu6050_8h_source.html">mpu6050.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hmc5883l_8h_source.html">hmc5883l.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bmp388_8h_source.html">bmp388.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="neo6m_8h_source.html">neo6m.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="health__aggregate_8h_source.html">health_aggregate.h</a>&quot;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
</div>
<p><a href="gcs__gateway_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:gcs_5Fgateway_5Fstate_5Ft" id="r_gcs_5Fgateway_5Fstate_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgcs__gateway__state__t.html">gcs_gateway_state_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gateway State.  <a href="structgcs__gateway__state__t.html#details">More...</a><br /></td></tr>
<tr class="memitem:gateway_5Fmessage_5Ft" id="r_gateway_5Fmessage_5Ft"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgateway__message__t.html">gateway_message_t</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-enum-members" class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ad2a35bff87442fa85608edeccf3875ef" id="r_ad2a35bff87442fa85608edeccf3875ef"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a> { <br />
&#160;&#160;<b>GCS_CMD_OK</b> = 0
, <b>GCS_CMD_ERR_UNAUTHORIZED</b> = 1
, <b>GCS_CMD_ERR_SAFETY_BLOCK</b> = 2
, <b>GCS_CMD_ERR_MODE_UNAVAILABLE</b> = 3
, <br />
&#160;&#160;<b>GCS_CMD_ERR_SENSORS</b> = 4
, <b>GCS_CMD_ERR_SYSTEM</b> = 5
, <b>GCS_CMD_ERR_INVALID_PARAM</b> = 6
, <b>GCS_CMD_ERR_INVALID_SESSION</b> = 7
, <br />
&#160;&#160;<b>GCS_CMD_ERR_RATE_LIMITED</b> = 8
, <b>GCS_CMD_ERR_TIMEOUT</b> = 9
, <b>GCS_CMD_ERR_HARDWARE</b> = 10
, <b>GCS_CMD_ERR_MAX</b> = 11
<br />
 }</td></tr>
<tr class="memdesc:ad2a35bff87442fa85608edeccf3875ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">GCS Command Result Codes.  <a href="#ad2a35bff87442fa85608edeccf3875ef">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae2e20232639b98898bc4862b2220df2a" id="r_ae2e20232639b98898bc4862b2220df2a"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae2e20232639b98898bc4862b2220df2a">gcs_gateway_get_timestamp_ms</a> (void)</td></tr>
<tr class="memdesc:ae2e20232639b98898bc4862b2220df2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current timestamp in milliseconds.  <br /></td></tr>
<tr class="memitem:a2c107614e698f49bfbcddf6fef972a6f" id="r_a2c107614e698f49bfbcddf6fef972a6f"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2c107614e698f49bfbcddf6fef972a6f">gcs_gateway_send_response</a> (uint32_t session_id, uint8_t sequence_num, scp_message_type_t message_type, const void *payload, size_t payload_size)</td></tr>
<tr class="memdesc:a2c107614e698f49bfbcddf6fef972a6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send response message to GCS.  <br /></td></tr>
<tr class="memitem:a7cff3f9292184b233e1045d1291a3459" id="r_a7cff3f9292184b233e1045d1291a3459"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7cff3f9292184b233e1045d1291a3459">gcs_gateway_send_audit_event</a> (uint8_t event_type, uint32_t source_session, uint8_t operator_role, uint8_t result_code, const uint8_t *details)</td></tr>
<tr class="memdesc:a7cff3f9292184b233e1045d1291a3459"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate and send TLM_AUDIT message for security/operational events.  <br /></td></tr>
<tr class="memitem:a153ca66b948e7dd6c491b90280d2d451" id="r_a153ca66b948e7dd6c491b90280d2d451"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a153ca66b948e7dd6c491b90280d2d451">gcs_gateway_audit_command_attempt</a> (uint32_t session_id, scp_message_type_t command_type, <a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a> result_code, uint32_t processing_time_ms)</td></tr>
<tr class="memdesc:a153ca66b948e7dd6c491b90280d2d451"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log command attempt audit event.  <br /></td></tr>
<tr class="memitem:a3310ce2147893470427e7cebc4c76ee2" id="r_a3310ce2147893470427e7cebc4c76ee2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3310ce2147893470427e7cebc4c76ee2">gcs_gateway_audit_auth_failure</a> (uint32_t session_id, uint8_t auth_failure_type, uint8_t sequence_num)</td></tr>
<tr class="memdesc:a3310ce2147893470427e7cebc4c76ee2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log authentication failure audit event.  <br /></td></tr>
<tr class="memitem:a1adb6be345d96d31daa1d76872c4cf90" id="r_a1adb6be345d96d31daa1d76872c4cf90"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1adb6be345d96d31daa1d76872c4cf90">gcs_gateway_audit_session_event</a> (uint32_t session_id, uint8_t event_subtype, uint8_t operator_role)</td></tr>
<tr class="memdesc:a1adb6be345d96d31daa1d76872c4cf90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log session lifecycle audit event.  <br /></td></tr>
<tr class="memitem:a3dcba2ea7d7476280dcfc386b66448b8" id="r_a3dcba2ea7d7476280dcfc386b66448b8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3dcba2ea7d7476280dcfc386b66448b8">gcs_gateway_audit_security_violation</a> (uint32_t session_id, uint8_t violation_type, uint8_t severity)</td></tr>
<tr class="memdesc:a3dcba2ea7d7476280dcfc386b66448b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log security violation audit event.  <br /></td></tr>
<tr class="memitem:a55166e38b2c176261ce6ac9300eb7bb5" id="r_a55166e38b2c176261ce6ac9300eb7bb5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a55166e38b2c176261ce6ac9300eb7bb5">gcs_gateway_validate_sequence</a> (uint32_t session_id, uint8_t sequence_num)</td></tr>
<tr class="memdesc:a55166e38b2c176261ce6ac9300eb7bb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enhanced replay attack detection (T029 - User Story 4).  <br /></td></tr>
<tr class="memitem:a9e0f12534c67a607b5b6e8af85160ad1" id="r_a9e0f12534c67a607b5b6e8af85160ad1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9e0f12534c67a607b5b6e8af85160ad1">gcs_gateway_check_enhanced_rate_limit</a> (uint32_t session_id)</td></tr>
<tr class="memdesc:a9e0f12534c67a607b5b6e8af85160ad1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rate limiting enhancement (T030 - User Story 4).  <br /></td></tr>
<tr class="memitem:a60f91d2e96133f2b68af9c98db64d429" id="r_a60f91d2e96133f2b68af9c98db64d429"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a60f91d2e96133f2b68af9c98db64d429">gcs_gateway_log_to_audit_system</a> (uint32_t session_id, scp_message_type_t command_type, <a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a> result_code, const char *command_summary)</td></tr>
<tr class="memdesc:a60f91d2e96133f2b68af9c98db64d429"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integration with existing audit system (T027 - User Story 4).  <br /></td></tr>
<tr class="memitem:a4610dcc9f3c3a6972c6177107f2fe179" id="r_a4610dcc9f3c3a6972c6177107f2fe179"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4610dcc9f3c3a6972c6177107f2fe179">gcs_gateway_log_security_violation</a> (const char *violation_type, uint32_t session_id, const char *details, const char *severity)</td></tr>
<tr class="memdesc:a4610dcc9f3c3a6972c6177107f2fe179"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log security violation to persistent FATFS storage (T032).  <br /></td></tr>
<tr class="memitem:a6e27797c5c75c818f9e5106ef38658b5" id="r_a6e27797c5c75c818f9e5106ef38658b5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e27797c5c75c818f9e5106ef38658b5">gcs_gateway_process_arm_command</a> (<a class="el" href="structscp__session__t.html">scp_session_t</a> *session, const scp_cmd_control_t *cmd_control, uint8_t sequence_num)</td></tr>
<tr class="memdesc:a6e27797c5c75c818f9e5106ef38658b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process ARM command.  <br /></td></tr>
<tr class="memitem:ad6d457e9eca6fec06108faf536fc123d" id="r_ad6d457e9eca6fec06108faf536fc123d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad6d457e9eca6fec06108faf536fc123d">gcs_gateway_process_disarm_command</a> (<a class="el" href="structscp__session__t.html">scp_session_t</a> *session, const scp_cmd_control_t *cmd_control, uint8_t sequence_num)</td></tr>
<tr class="memdesc:ad6d457e9eca6fec06108faf536fc123d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process DISARM command.  <br /></td></tr>
<tr class="memitem:a49d6070ef0a5b0f4d549e04f9600ad8b" id="r_a49d6070ef0a5b0f4d549e04f9600ad8b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a49d6070ef0a5b0f4d549e04f9600ad8b">gcs_gateway_process_mode_change</a> (<a class="el" href="structscp__session__t.html">scp_session_t</a> *session, const scp_cmd_control_t *cmd_control, uint8_t sequence_num)</td></tr>
<tr class="memdesc:a49d6070ef0a5b0f4d549e04f9600ad8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process mode change command.  <br /></td></tr>
<tr class="memitem:ab2afa44ed361a2eeb29f26466bdd275d" id="r_ab2afa44ed361a2eeb29f26466bdd275d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2afa44ed361a2eeb29f26466bdd275d">gcs_gateway_process_cmd_control</a> (uint32_t session_id, uint8_t sequence_num, const uint8_t *payload, size_t payload_size)</td></tr>
<tr class="memdesc:ab2afa44ed361a2eeb29f26466bdd275d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process CMD_CONTROL message.  <br /></td></tr>
<tr class="memitem:a89f72184ab36751f12a46f1ed444dbce" id="r_a89f72184ab36751f12a46f1ed444dbce"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a89f72184ab36751f12a46f1ed444dbce">gcs_gateway_process_message</a> (const <a class="el" href="structgateway__message__t.html">gateway_message_t</a> *message)</td></tr>
<tr class="memdesc:a89f72184ab36751f12a46f1ed444dbce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process received message and generate appropriate response.  <br /></td></tr>
<tr class="memitem:a197e8ba3bc46632a45f8df486838ef2f" id="r_a197e8ba3bc46632a45f8df486838ef2f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a197e8ba3bc46632a45f8df486838ef2f">gcs_gateway_task</a> (void *param)</td></tr>
<tr class="memdesc:a197e8ba3bc46632a45f8df486838ef2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main gateway processing task.  <br /></td></tr>
<tr class="memitem:a4babafa951acc4ead62d4d30d9ea57ca" id="r_a4babafa951acc4ead62d4d30d9ea57ca"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4babafa951acc4ead62d4d30d9ea57ca">gcs_gateway_init</a> (void)</td></tr>
<tr class="memdesc:a4babafa951acc4ead62d4d30d9ea57ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize GCS Gateway.  <br /></td></tr>
<tr class="memitem:ab35e49adcac5ce815665adb366d24e55" id="r_ab35e49adcac5ce815665adb366d24e55"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab35e49adcac5ce815665adb366d24e55">gcs_gateway_receive_message</a> (uint32_t session_id, uint8_t sequence_num, scp_message_type_t message_type, const uint8_t *payload, size_t payload_size)</td></tr>
<tr class="memitem:ab5924908f2051169c04b4ab71ffa45f9" id="r_ab5924908f2051169c04b4ab71ffa45f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab5924908f2051169c04b4ab71ffa45f9">gcs_gateway_get_stats</a> (<a class="el" href="structgcs__gateway__stats__t.html">gcs_gateway_stats_t</a> *stats)</td></tr>
<tr class="memdesc:ab5924908f2051169c04b4ab71ffa45f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Gateway Statistics.  <br /></td></tr>
<tr class="memitem:a5447fc56f6cd48471af3b5a5bbf2eb6e" id="r_a5447fc56f6cd48471af3b5a5bbf2eb6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5447fc56f6cd48471af3b5a5bbf2eb6e">gcs_gateway_reset_stats</a> (void)</td></tr>
<tr class="memdesc:a5447fc56f6cd48471af3b5a5bbf2eb6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset Gateway Statistics.  <br /></td></tr>
<tr class="memitem:a5f2e66e88feb6d50b7280a23a2a96a78" id="r_a5f2e66e88feb6d50b7280a23a2a96a78"><td class="memItemLeft" align="right" valign="top">static esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5f2e66e88feb6d50b7280a23a2a96a78">gcs_gateway_generate_tlm_status</a> (scp_tlm_status_t *status)</td></tr>
<tr class="memdesc:a5f2e66e88feb6d50b7280a23a2a96a78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate TLM_STATUS message with current system state.  <br /></td></tr>
<tr class="memitem:a2d0f4bb58e0f0d79c101c34efa6e872e" id="r_a2d0f4bb58e0f0d79c101c34efa6e872e"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d0f4bb58e0f0d79c101c34efa6e872e">gcs_gateway_get_telemetry_priority</a> (const scp_tlm_status_t *status)</td></tr>
<tr class="memdesc:a2d0f4bb58e0f0d79c101c34efa6e872e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine telemetry priority based on system state (T040).  <br /></td></tr>
<tr class="memitem:a2a421259831dbc0cdc2f4515320f52b2" id="r_a2a421259831dbc0cdc2f4515320f52b2"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2a421259831dbc0cdc2f4515320f52b2">gcs_gateway_queue_telemetry</a> (const scp_tlm_status_t *status, uint32_t session_id, uint8_t priority)</td></tr>
<tr class="memdesc:a2a421259831dbc0cdc2f4515320f52b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add telemetry message to priority queue (T040).  <br /></td></tr>
<tr class="memitem:a83f48b6860d112f487bc6fd5e9234cfd" id="r_a83f48b6860d112f487bc6fd5e9234cfd"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83f48b6860d112f487bc6fd5e9234cfd">gcs_gateway_process_priority_queue</a> (void)</td></tr>
<tr class="memdesc:a83f48b6860d112f487bc6fd5e9234cfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process priority telemetry queue (T040).  <br /></td></tr>
<tr class="memitem:a1536d2c3bcce106c2bc6d9f78a989fe5" id="r_a1536d2c3bcce106c2bc6d9f78a989fe5"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1536d2c3bcce106c2bc6d9f78a989fe5">gcs_gateway_send_tlm_status_targeted</a> (uint32_t target_session_id)</td></tr>
<tr class="memdesc:a1536d2c3bcce106c2bc6d9f78a989fe5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send TLM_STATUS message to sessions with role-based filtering.  <br /></td></tr>
<tr class="memitem:a7a91f98fa0fdca641bcc900e50dfd8c4" id="r_a7a91f98fa0fdca641bcc900e50dfd8c4"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a91f98fa0fdca641bcc900e50dfd8c4">gcs_gateway_send_tlm_status</a> (void)</td></tr>
<tr class="memdesc:a7a91f98fa0fdca641bcc900e50dfd8c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send TLM_STATUS to all eligible sessions (backward compatibility).  <br /></td></tr>
<tr class="memitem:ad83c9707cb66537d3b86ab36f9cd1746" id="r_ad83c9707cb66537d3b86ab36f9cd1746"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad83c9707cb66537d3b86ab36f9cd1746">gcs_gateway_set_telemetry_rate</a> (uint8_t rate_hz)</td></tr>
<tr class="memdesc:ad83c9707cb66537d3b86ab36f9cd1746"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set telemetry rate (T038 - Rate Control).  <br /></td></tr>
<tr class="memitem:a21579225d41c570fa10009684a1bc5ee" id="r_a21579225d41c570fa10009684a1bc5ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a21579225d41c570fa10009684a1bc5ee">gcs_gateway_set_telemetry_enabled</a> (bool enabled)</td></tr>
<tr class="memdesc:a21579225d41c570fa10009684a1bc5ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable/disable telemetry streaming.  <br /></td></tr>
<tr class="memitem:a44f0f6feedc2067cf54d542ec344ce3e" id="r_a44f0f6feedc2067cf54d542ec344ce3e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44f0f6feedc2067cf54d542ec344ce3e">gcs_gateway_get_telemetry_stats</a> (<a class="el" href="structgcs__telemetry__stats__t.html">gcs_telemetry_stats_t</a> *stats_out)</td></tr>
<tr class="memdesc:a44f0f6feedc2067cf54d542ec344ce3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get telemetry timing statistics (T038).  <br /></td></tr>
<tr class="memitem:a3857394a824df482caa7671d16600ab3" id="r_a3857394a824df482caa7671d16600ab3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3857394a824df482caa7671d16600ab3">gcs_gateway_set_session_telemetry</a> (uint32_t session_id, bool enabled, uint8_t rate_hz)</td></tr>
<tr class="memdesc:a3857394a824df482caa7671d16600ab3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure per-session telemetry (T039).  <br /></td></tr>
<tr class="memitem:a51dea74cac321a776330663f9c26cb72" id="r_a51dea74cac321a776330663f9c26cb72"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a51dea74cac321a776330663f9c26cb72">gcs_gateway_get_session_telemetry_stats</a> (uint32_t session_id, <a class="el" href="structgcs__session__telemetry__stats__t.html">gcs_session_telemetry_stats_t</a> *stats_out)</td></tr>
<tr class="memdesc:a51dea74cac321a776330663f9c26cb72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get session telemetry statistics (T039).  <br /></td></tr>
<tr class="memitem:ad2cbebcb31c27d10fbd33eba01f7eb84" id="r_ad2cbebcb31c27d10fbd33eba01f7eb84"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad2cbebcb31c27d10fbd33eba01f7eb84">gcs_gateway_update_telemetry</a> (void)</td></tr>
<tr class="memdesc:ad2cbebcb31c27d10fbd33eba01f7eb84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update telemetry system (T037/T038 - Integration with Timing Validation).  <br /></td></tr>
<tr class="memitem:ae0eab345140ff4574bc769d9edecd725" id="r_ae0eab345140ff4574bc769d9edecd725"><td class="memItemLeft" align="right" valign="top">esp_err_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae0eab345140ff4574bc769d9edecd725">gcs_gateway_log_critical_security_event</a> (const char *violation_type, const char *details)</td></tr>
<tr class="memdesc:ae0eab345140ff4574bc769d9edecd725"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log critical system security event (T032 - Enhanced).  <br /></td></tr>
<tr class="memitem:a57bafb9d70f0d46749f934f37fa9179d" id="r_a57bafb9d70f0d46749f934f37fa9179d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57bafb9d70f0d46749f934f37fa9179d">gcs_gateway_get_priority_queue_stats</a> (<a class="el" href="structgcs__priority__queue__stats__t.html">gcs_priority_queue_stats_t</a> *stats_out)</td></tr>
<tr class="memdesc:a57bafb9d70f0d46749f934f37fa9179d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get priority queue statistics (T040).  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5a85b9c772bbeb480b209a3e6ea92b4c" id="r_a5a85b9c772bbeb480b209a3e6ea92b4c"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a85b9c772bbeb480b209a3e6ea92b4c">TAG</a> = &quot;gcs_gateway&quot;</td></tr>
<tr class="memitem:a6f577249fc45255776e1d70fc86e5c57" id="r_a6f577249fc45255776e1d70fc86e5c57"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structgcs__gateway__state__t.html">gcs_gateway_state_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f577249fc45255776e1d70fc86e5c57">gateway_state</a> = {0}</td></tr>
<tr class="memitem:"><td class="memItemLeft anon">struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:ae266fe4eed712f836d086888e1f0adfe" id="r_ae266fe4eed712f836d086888e1f0adfe"><td class="memItemLeft anon">&#160;&#160;&#160;uint8_t&#160;&#160;&#160;<a class="el" href="#a4fa2ae72a50d96cafd7b5d2449738ee6">rate_hz</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a5627e0e463686fb134fa25d638a7d01b" id="r_a5627e0e463686fb134fa25d638a7d01b"><td class="memItemLeft anon">&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#a98bc9f0db3bcd05842377ff9acd776ab">last_status_send_ms</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:ad373acd6b091cbff785036a3c2050041" id="r_ad373acd6b091cbff785036a3c2050041"><td class="memItemLeft anon">&#160;&#160;&#160;bool&#160;&#160;&#160;<a class="el" href="#a8740ba80e30dd75e71d09fa1dcf04f3d">enabled</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a7efc25f2a1c71701e29e0966db3dd6b1" id="r_a7efc25f2a1c71701e29e0966db3dd6b1"><td class="memItemLeft anon">&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#af2530f13abb29e07f381eb1981b7506e">target_interval_ms</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a470cc821429a6bec8befa33b3651fee0" id="r_a470cc821429a6bec8befa33b3651fee0"><td class="memItemLeft anon">&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#acef5d96a9c9b1c478f720b3b2461b72f">total_transmissions</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a5e006e7700b2ddfbc21fa46da405d115" id="r_a5e006e7700b2ddfbc21fa46da405d115"><td class="memItemLeft anon">&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#ae1e2374c9b71293bc93e31c87b039894">on_time_transmissions</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a9014a1e25957499fe9ecd7639ad61f39" id="r_a9014a1e25957499fe9ecd7639ad61f39"><td class="memItemLeft anon">&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#aacc9eed65e566cbd0b181effba8049f4">late_transmissions</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a85b083e8b2b5d0e77a3dda74e0f646b2" id="r_a85b083e8b2b5d0e77a3dda74e0f646b2"><td class="memItemLeft anon">&#160;&#160;&#160;int32_t&#160;&#160;&#160;<a class="el" href="#a24e382a26a40d5325a87f163cc5eb2b9">max_jitter_ms</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:ae37120aa8b7bde4de13b52cd2740b2ce" id="r_ae37120aa8b7bde4de13b52cd2740b2ce"><td class="memItemLeft anon">&#160;&#160;&#160;int32_t&#160;&#160;&#160;<a class="el" href="#a16198e0c866cad958cecdf248c433935">min_jitter_ms</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:aacc0d649151b8fe2d4af569bfada1bb6" id="r_aacc0d649151b8fe2d4af569bfada1bb6"><td class="memItemLeft anon">&#160;&#160;&#160;int32_t&#160;&#160;&#160;<a class="el" href="#a9713034dbde3ab96440b43b59b7c3cd0">avg_jitter_ms</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:ad97b0d1f1522b3ab86c6b79783397d44" id="r_ad97b0d1f1522b3ab86c6b79783397d44"><td class="memItemLeft anon">&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#abd5571c93c0ff928fd21f89a40193601">jitter_samples</a> [16]&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a432521313d4e345d0c0480b61c063166" id="r_a432521313d4e345d0c0480b61c063166"><td class="memItemLeft anon">&#160;&#160;&#160;uint8_t&#160;&#160;&#160;<a class="el" href="#ad58e8ff6bdc959d987d263e7319ef484">jitter_sample_idx</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a546476c3ecbd9655becda7b4ad9d0e92" id="r_a546476c3ecbd9655becda7b4ad9d0e92"><td class="memItemLeft anon">&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#a6a9a0176b0b18801c4618496ab988033">rate_limit_drops</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a8f8009d008b0f697057527278381d8a9" id="r_a8f8009d008b0f697057527278381d8a9"><td class="memItemLeft anon">&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#a95a87959d972f5419c6570f26d392d52">last_drop_timestamp_ms</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:"><td class="memItemLeft anon">
&#160;&#160;&#160;struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a6f9e80f8409a87750957ee3d50866ed2" id="r_a6f9e80f8409a87750957ee3d50866ed2"><td class="memItemLeft anon">&#160;&#160;&#160;&#160;&#160;&#160;bool&#160;&#160;&#160;<a class="el" href="#a8740ba80e30dd75e71d09fa1dcf04f3d">enabled</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a80af8ec4df7d17a03026366a31c34847" id="r_a80af8ec4df7d17a03026366a31c34847"><td class="memItemLeft anon">&#160;&#160;&#160;&#160;&#160;&#160;uint8_t&#160;&#160;&#160;<a class="el" href="#a4fa2ae72a50d96cafd7b5d2449738ee6">rate_hz</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a243fb5a89a3008725ae5fe16f6e11248" id="r_a243fb5a89a3008725ae5fe16f6e11248"><td class="memItemLeft anon">&#160;&#160;&#160;&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#a20175605c493200e4834cf694b0ecf64">last_send_ms</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:ac0ccd243cd0139746f3c670b2a333f49" id="r_ac0ccd243cd0139746f3c670b2a333f49"><td class="memItemLeft anon">&#160;&#160;&#160;&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#a9fd07219efd4a65aa9d4022a28938f6d">messages_sent</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:adf39cf250a7699bfe5b0163b37efa2a9" id="r_adf39cf250a7699bfe5b0163b37efa2a9"><td class="memItemLeft anonEnd" valign="top">&#160;&#160;&#160;}&#160;&#160;&#160;<b>session_config</b> [SCP_MAX_SESSIONS]</td></tr>
<tr class="memitem:"><td class="memItemLeft anon">
&#160;&#160;&#160;struct {&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a86392cae7047f5ce46995b01f18c25f0" id="r_a86392cae7047f5ce46995b01f18c25f0"><td class="memItemLeft anon">&#160;&#160;&#160;&#160;&#160;&#160;scp_tlm_status_t&#160;&#160;&#160;<a class="el" href="#a6788eb7712e0df3bc1446e50edc14399">message</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a97cb8215afbba4bdfeb0186e5831db44" id="r_a97cb8215afbba4bdfeb0186e5831db44"><td class="memItemLeft anon">&#160;&#160;&#160;&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#a946f27f64a6c7500925f6d10c0b007aa">session_id</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a823914a0c4ee981de1bdeb2ca592659f" id="r_a823914a0c4ee981de1bdeb2ca592659f"><td class="memItemLeft anon">&#160;&#160;&#160;&#160;&#160;&#160;uint8_t&#160;&#160;&#160;<a class="el" href="#a0ad043071ccc7a261d79a759dc9c6f0c">priority</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a3984927cc1529ec0166641efe54b874d" id="r_a3984927cc1529ec0166641efe54b874d"><td class="memItemLeft anon">&#160;&#160;&#160;&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#a7151fee88ade6cc487805f36f80cf619">timestamp_ms</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:aca158917c20af7c17a7101e5692510f5" id="r_aca158917c20af7c17a7101e5692510f5"><td class="memItemLeft anon">&#160;&#160;&#160;&#160;&#160;&#160;uint8_t&#160;&#160;&#160;<a class="el" href="#ad7f3b7d0c00bba5352cf56e5ecd54519">retry_count</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:ad2eeba0347838605c5d1a2f3151cf4ee" id="r_ad2eeba0347838605c5d1a2f3151cf4ee"><td class="memItemLeft anonEnd" valign="top">&#160;&#160;&#160;}&#160;&#160;&#160;<b>priority_queue</b> [16]</td></tr>
<tr class="memitem:a477716ebf71ea788cf8aefc4ebc56000" id="r_a477716ebf71ea788cf8aefc4ebc56000"><td class="memItemLeft anon">&#160;&#160;&#160;uint8_t&#160;&#160;&#160;<a class="el" href="#aa94108f5f84135a0bca0eaf7277a4e1f">queue_size</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a4aa6a29c015000311e18453d23d27f9d" id="r_a4aa6a29c015000311e18453d23d27f9d"><td class="memItemLeft anon">&#160;&#160;&#160;uint8_t&#160;&#160;&#160;<a class="el" href="#abe932822de80975284f0dbe9541ac151">queue_high_priority_count</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a867a74679bd8ef58fdba79761e63e46d" id="r_a867a74679bd8ef58fdba79761e63e46d"><td class="memItemLeft anon">&#160;&#160;&#160;uint32_t&#160;&#160;&#160;<a class="el" href="#a761cfe1f0fb3b551a67b50cf7f5d8dd3">priority_drops</a>&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memitem:a4f3e3674418e2d09c40f472f793d65e0" id="r_a4f3e3674418e2d09c40f472f793d65e0"><td class="memItemLeft anonEnd" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f3e3674418e2d09c40f472f793d65e0">telemetry_state</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>GCS Gateway Service Implementation. </p>
<p>Implements the GCS gateway service for Secure Control Protocol (SCP) v1.1, providing message routing, command processing, and response handling between ground control systems and the Scout flight controller.</p>
<p>Features:</p><ul>
<li>CMD_CONTROL message processing (ARM/DISARM, mode changes)</li>
<li>ACK_RESPONSE and ERR_RESPONSE generation</li>
<li>Integration with safety_manager for command validation</li>
<li>Role-based authorization enforcement</li>
<li>Real-time command processing (&lt;100ms target)</li>
<li>Comprehensive audit logging</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Scout ISR Project </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2025-10-26 </dd></dl>

<p class="definition">Definition in file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>
</div><a name="doc-enum-members" id="doc-enum-members"></a><h2 id="header-doc-enum-members" class="groupheader">Enumeration Type Documentation</h2>
<a id="ad2a35bff87442fa85608edeccf3875ef" name="ad2a35bff87442fa85608edeccf3875ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2a35bff87442fa85608edeccf3875ef">&#9670;&#160;</a></span>gcs_command_result_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GCS Command Result Codes. </p>
<p>Result codes returned by GCS command processing functions. Used for generating appropriate ACK/ERR responses. </p>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00062">62</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a3310ce2147893470427e7cebc4c76ee2" name="a3310ce2147893470427e7cebc4c76ee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3310ce2147893470427e7cebc4c76ee2">&#9670;&#160;</a></span>gcs_gateway_audit_auth_failure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_audit_auth_failure </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>auth_failure_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>sequence_num</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log authentication failure audit event. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session that failed authentication (0 if unknown) </td></tr>
    <tr><td class="paramname">auth_failure_type</td><td>Type of authentication failure </td></tr>
    <tr><td class="paramname">sequence_num</td><td>Sequence number that failed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00314">314</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00197">gcs_gateway_send_audit_event()</a>, and <a class="el" href="scp__session_8c_source.html#l00709">scp_session_get_by_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00836">gcs_gateway_process_cmd_control()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l00404">gcs_gateway_validate_sequence()</a>.</p>

</div>
</div>
<a id="a153ca66b948e7dd6c491b90280d2d451" name="a153ca66b948e7dd6c491b90280d2d451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a153ca66b948e7dd6c491b90280d2d451">&#9670;&#160;</a></span>gcs_gateway_audit_command_attempt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_audit_command_attempt </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">scp_message_type_t</td>          <td class="paramname"><span class="paramname"><em>command_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a></td>          <td class="paramname"><span class="paramname"><em>result_code</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>processing_time_ms</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log command attempt audit event. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session that sent the command </td></tr>
    <tr><td class="paramname">command_type</td><td>Type of command attempted </td></tr>
    <tr><td class="paramname">result_code</td><td>Command processing result </td></tr>
    <tr><td class="paramname">processing_time_ms</td><td>Time taken to process command </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00280">280</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00197">gcs_gateway_send_audit_event()</a>, and <a class="el" href="scp__session_8c_source.html#l00709">scp_session_get_by_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00937">gcs_gateway_process_message()</a>.</p>

</div>
</div>
<a id="a3dcba2ea7d7476280dcfc386b66448b8" name="a3dcba2ea7d7476280dcfc386b66448b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dcba2ea7d7476280dcfc386b66448b8">&#9670;&#160;</a></span>gcs_gateway_audit_security_violation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_audit_security_violation </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>violation_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>severity</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log security violation audit event. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session that triggered violation (0 if unknown) </td></tr>
    <tr><td class="paramname">violation_type</td><td>Type of security violation </td></tr>
    <tr><td class="paramname">severity</td><td>Severity level of violation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00369">369</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00197">gcs_gateway_send_audit_event()</a>, and <a class="el" href="scp__session_8c_source.html#l00709">scp_session_get_by_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00444">gcs_gateway_check_enhanced_rate_limit()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00836">gcs_gateway_process_cmd_control()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l00404">gcs_gateway_validate_sequence()</a>.</p>

</div>
</div>
<a id="a1adb6be345d96d31daa1d76872c4cf90" name="a1adb6be345d96d31daa1d76872c4cf90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1adb6be345d96d31daa1d76872c4cf90">&#9670;&#160;</a></span>gcs_gateway_audit_session_event()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_audit_session_event </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>event_subtype</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>operator_role</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log session lifecycle audit event. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session ID </td></tr>
    <tr><td class="paramname">event_subtype</td><td>Session event type (create, close, timeout) </td></tr>
    <tr><td class="paramname">operator_role</td><td>Role of operator </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00346">346</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00197">gcs_gateway_send_audit_event()</a>.</p>

</div>
</div>
<a id="a9e0f12534c67a607b5b6e8af85160ad1" name="a9e0f12534c67a607b5b6e8af85160ad1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e0f12534c67a607b5b6e8af85160ad1">&#9670;&#160;</a></span>gcs_gateway_check_enhanced_rate_limit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool gcs_gateway_check_enhanced_rate_limit </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rate limiting enhancement (T030 - User Story 4). </p>
<p>Enhanced rate limiting with burst allowance and security monitoring </p>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00444">444</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00369">gcs_gateway_audit_security_violation()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00122">gcs_gateway_get_timestamp_ms()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00545">gcs_gateway_log_security_violation()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00480">gcs_gateway_log_to_audit_system()</a>, and <a class="el" href="scp__session_8c_source.html#l00514">scp_session_check_rate_limit()</a>.</p>

</div>
</div>
<a id="a5f2e66e88feb6d50b7280a23a2a96a78" name="a5f2e66e88feb6d50b7280a23a2a96a78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f2e66e88feb6d50b7280a23a2a96a78">&#9670;&#160;</a></span>gcs_gateway_generate_tlm_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t gcs_gateway_generate_tlm_status </td>
          <td>(</td>
          <td class="paramtype">scp_tlm_status_t *</td>          <td class="paramname"><span class="paramname"><em>status</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate TLM_STATUS message with current system state. </p>
<p>Integrates with existing telemetry_core and sensor systems to generate comprehensive status telemetry for GCS streaming.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">status</td><td>Output buffer for status message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, error code on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01300">1300</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="mpu6050_8h_source.html#l00038">mpu6050_data_t::accel_x</a>, <a class="el" href="mpu6050_8h_source.html#l00039">mpu6050_data_t::accel_y</a>, <a class="el" href="mpu6050_8h_source.html#l00040">mpu6050_data_t::accel_z</a>, <a class="el" href="bmp388_8h_source.html#l00036">bmp388_data_t::altitude</a>, <a class="el" href="bmp388_8c_source.html#l00347">bmp388_get_instance()</a>, <a class="el" href="bmp388_8c_source.html#l00277">bmp388_read_scaled()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00122">gcs_gateway_get_timestamp_ms()</a>, <a class="el" href="hmc5883l_8h_source.html#l00037">hmc5883l_data_t::heading</a>, <a class="el" href="hmc5883l_8c_source.html#l00367">hmc5883l_get_instance()</a>, <a class="el" href="hmc5883l_8c_source.html#l00216">hmc5883l_read_scaled()</a>, <a class="el" href="mpu6050_8h_source.html#l00085">mpu6050_t::initialized</a>, <a class="el" href="neo6m_8h_source.html#l00045">neo6m_t::initialized</a>, <a class="el" href="mpu6050_8c_source.html#l00360">mpu6050_get_instance()</a>, <a class="el" href="mpu6050_8c_source.html#l00204">mpu6050_read_scaled()</a>, and <a class="el" href="neo6m_8c_source.html#l00170">neo6m_get_instance()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l01619">gcs_gateway_send_tlm_status_targeted()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l01917">gcs_gateway_update_telemetry()</a>.</p>

</div>
</div>
<a id="a57bafb9d70f0d46749f934f37fa9179d" name="a57bafb9d70f0d46749f934f37fa9179d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57bafb9d70f0d46749f934f37fa9179d">&#9670;&#160;</a></span>gcs_gateway_get_priority_queue_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_get_priority_queue_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgcs__priority__queue__stats__t.html">gcs_priority_queue_stats_t</a> *</td>          <td class="paramname"><span class="paramname"><em>stats_out</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get priority queue statistics (T040). </p>
<p>Get Priority Queue Statistics (T040).</p>
<p>Retrieves statistics about the priority-based telemetry queue.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stats_out</td><td>Output buffer for queue statistics </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l02050">2050</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a51dea74cac321a776330663f9c26cb72" name="a51dea74cac321a776330663f9c26cb72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51dea74cac321a776330663f9c26cb72">&#9670;&#160;</a></span>gcs_gateway_get_session_telemetry_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool gcs_gateway_get_session_telemetry_stats </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgcs__session__telemetry__stats__t.html">gcs_session_telemetry_stats_t</a> *</td>          <td class="paramname"><span class="paramname"><em>stats_out</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get session telemetry statistics (T039). </p>
<p>Get Session Telemetry Statistics (T039).</p>
<p>Retrieves telemetry statistics for a specific session.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Target session ID </td></tr>
    <tr><td class="paramname">stats_out</td><td>Output buffer for session statistics </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if session found, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01880">1880</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="ab5924908f2051169c04b4ab71ffa45f9" name="ab5924908f2051169c04b4ab71ffa45f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5924908f2051169c04b4ab71ffa45f9">&#9670;&#160;</a></span>gcs_gateway_get_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_get_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgcs__gateway__stats__t.html">gcs_gateway_stats_t</a> *</td>          <td class="paramname"><span class="paramname"><em>stats_out</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get Gateway Statistics. </p>
<p>Retrieves operational statistics for monitoring.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stats_out</td><td>Output buffer for statistics </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01192">1192</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00545">gcs_gateway_log_security_violation()</a>.</p>

</div>
</div>
<a id="a2d0f4bb58e0f0d79c101c34efa6e872e" name="a2d0f4bb58e0f0d79c101c34efa6e872e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d0f4bb58e0f0d79c101c34efa6e872e">&#9670;&#160;</a></span>gcs_gateway_get_telemetry_priority()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t gcs_gateway_get_telemetry_priority </td>
          <td>(</td>
          <td class="paramtype">const scp_tlm_status_t *</td>          <td class="paramname"><span class="paramname"><em>status</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine telemetry priority based on system state (T040). </p>
<p>Analyzes current system status to determine appropriate priority level for TLM_STATUS messages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">status</td><td>Status message to analyze </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Priority level (SCP_PRIORITY_*) </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01441">1441</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l01917">gcs_gateway_update_telemetry()</a>.</p>

</div>
</div>
<a id="a44f0f6feedc2067cf54d542ec344ce3e" name="a44f0f6feedc2067cf54d542ec344ce3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44f0f6feedc2067cf54d542ec344ce3e">&#9670;&#160;</a></span>gcs_gateway_get_telemetry_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_get_telemetry_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgcs__telemetry__stats__t.html">gcs_telemetry_stats_t</a> *</td>          <td class="paramname"><span class="paramname"><em>stats_out</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get telemetry timing statistics (T038). </p>
<p>Get Telemetry Timing Statistics (T038).</p>
<p>Retrieves detailed timing and performance statistics for telemetry analysis.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stats_out</td><td>Output buffer for telemetry timing statistics </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01788">1788</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="ae2e20232639b98898bc4862b2220df2a" name="ae2e20232639b98898bc4862b2220df2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2e20232639b98898bc4862b2220df2a">&#9670;&#160;</a></span>gcs_gateway_get_timestamp_ms()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t gcs_gateway_get_timestamp_ms </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get current timestamp in milliseconds. </p>
<dl class="section return"><dt>Returns</dt><dd>Current system timestamp </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00122">122</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00444">gcs_gateway_check_enhanced_rate_limit()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01300">gcs_gateway_generate_tlm_status()</a>, <a class="el" href="gcs__gateway_8c_source.html#l02050">gcs_gateway_get_priority_queue_stats()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01069">gcs_gateway_init()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00480">gcs_gateway_log_to_audit_system()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00836">gcs_gateway_process_cmd_control()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00937">gcs_gateway_process_message()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01533">gcs_gateway_process_priority_queue()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01476">gcs_gateway_queue_telemetry()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00197">gcs_gateway_send_audit_event()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00136">gcs_gateway_send_response()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01619">gcs_gateway_send_tlm_status_targeted()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l01917">gcs_gateway_update_telemetry()</a>.</p>

</div>
</div>
<a id="a4babafa951acc4ead62d4d30d9ea57ca" name="a4babafa951acc4ead62d4d30d9ea57ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4babafa951acc4ead62d4d30d9ea57ca">&#9670;&#160;</a></span>gcs_gateway_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool gcs_gateway_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize GCS Gateway. </p>
<p>Initializes the GCS gateway subsystem including transport interfaces, FreeRTOS tasks, and protocol state.</p>
<dl class="section return"><dt>Returns</dt><dd>true if initialization successful, false on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01069">1069</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="ae0eab345140ff4574bc769d9edecd725" name="ae0eab345140ff4574bc769d9edecd725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0eab345140ff4574bc769d9edecd725">&#9670;&#160;</a></span>gcs_gateway_log_critical_security_event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t gcs_gateway_log_critical_security_event </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>violation_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>details</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Log critical system security event (T032 - Enhanced). </p>
<p>Log Critical System Security Event.</p>
<p>Public interface for logging system-level security events from other components. Used for security violations detected outside of normal command processing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">violation_type</td><td>Type of security violation </td></tr>
    <tr><td class="paramname">details</td><td>Additional violation details </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, error code on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l02038">2038</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a4610dcc9f3c3a6972c6177107f2fe179" name="a4610dcc9f3c3a6972c6177107f2fe179"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4610dcc9f3c3a6972c6177107f2fe179">&#9670;&#160;</a></span>gcs_gateway_log_security_violation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">esp_err_t gcs_gateway_log_security_violation </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>violation_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>details</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>severity</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log security violation to persistent FATFS storage (T032). </p>
<p>Records critical security violations to FATFS blackbox for persistent audit trails that survive system restarts. Used for high-severity security events that require forensic analysis beyond the volatile audit system.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">violation_type</td><td>Type of security violation </td></tr>
    <tr><td class="paramname">session_id</td><td>Session ID where violation occurred (0 if system-level) </td></tr>
    <tr><td class="paramname">details</td><td>Additional violation details </td></tr>
    <tr><td class="paramname">severity</td><td>Violation severity level </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ESP_OK on success, error code on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00545">545</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="src_2services_2blackbox_8c_source.html#l00302">blackbox_is_initialized()</a>, <a class="el" href="src_2services_2blackbox_8c_source.html#l00380">blackbox_log_event()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01192">gcs_gateway_get_stats()</a>, <a class="el" href="scp__session_8c_source.html#l00297">scp_connection_get_name()</a>, <a class="el" href="scp__session_8c_source.html#l00282">scp_role_get_name()</a>, and <a class="el" href="scp__session_8c_source.html#l00709">scp_session_get_by_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00444">gcs_gateway_check_enhanced_rate_limit()</a>, <a class="el" href="gcs__gateway_8c_source.html#l02038">gcs_gateway_log_critical_security_event()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00836">gcs_gateway_process_cmd_control()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l00404">gcs_gateway_validate_sequence()</a>.</p>

</div>
</div>
<a id="a60f91d2e96133f2b68af9c98db64d429" name="a60f91d2e96133f2b68af9c98db64d429"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60f91d2e96133f2b68af9c98db64d429">&#9670;&#160;</a></span>gcs_gateway_log_to_audit_system()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_log_to_audit_system </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">scp_message_type_t</td>          <td class="paramname"><span class="paramname"><em>command_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a></td>          <td class="paramname"><span class="paramname"><em>result_code</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>command_summary</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Integration with existing audit system (T027 - User Story 4). </p>
<p>Logs SCP command to the existing companion audit system for unified audit trails </p>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00480">480</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="audit_8c_source.html#l00162">audit_is_initialized()</a>, <a class="el" href="audit_8c_source.html#l00196">audit_process_companion_input()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00122">gcs_gateway_get_timestamp_ms()</a>, <a class="el" href="scp__session_8c_source.html#l00282">scp_role_get_name()</a>, and <a class="el" href="scp__session_8c_source.html#l00709">scp_session_get_by_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00444">gcs_gateway_check_enhanced_rate_limit()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00635">gcs_gateway_process_arm_command()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00715">gcs_gateway_process_disarm_command()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l00768">gcs_gateway_process_mode_change()</a>.</p>

</div>
</div>
<a id="a6e27797c5c75c818f9e5106ef38658b5" name="a6e27797c5c75c818f9e5106ef38658b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e27797c5c75c818f9e5106ef38658b5">&#9670;&#160;</a></span>gcs_gateway_process_arm_command()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a> gcs_gateway_process_arm_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscp__session__t.html">scp_session_t</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const scp_cmd_control_t *</td>          <td class="paramname"><span class="paramname"><em>cmd_control</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>sequence_num</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process ARM command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Session requesting the command </td></tr>
    <tr><td class="paramname">cmd_control</td><td>Command control message </td></tr>
    <tr><td class="paramname">sequence_num</td><td>Message sequence number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Command processing result </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00635">635</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00480">gcs_gateway_log_to_audit_system()</a>, <a class="el" href="scp__session_8c_source.html#l00244">scp_role_can_execute()</a>, and <a class="el" href="scp__session_8c_source.html#l00282">scp_role_get_name()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00836">gcs_gateway_process_cmd_control()</a>.</p>

</div>
</div>
<a id="ab2afa44ed361a2eeb29f26466bdd275d" name="ab2afa44ed361a2eeb29f26466bdd275d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2afa44ed361a2eeb29f26466bdd275d">&#9670;&#160;</a></span>gcs_gateway_process_cmd_control()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a> gcs_gateway_process_cmd_control </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>sequence_num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>payload</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>payload_size</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process CMD_CONTROL message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Source session ID </td></tr>
    <tr><td class="paramname">sequence_num</td><td>Message sequence number </td></tr>
    <tr><td class="paramname">payload</td><td>Message payload </td></tr>
    <tr><td class="paramname">payload_size</td><td>Payload size </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Command processing result </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00836">836</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00314">gcs_gateway_audit_auth_failure()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00369">gcs_gateway_audit_security_violation()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00122">gcs_gateway_get_timestamp_ms()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00545">gcs_gateway_log_security_violation()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00635">gcs_gateway_process_arm_command()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00715">gcs_gateway_process_disarm_command()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00768">gcs_gateway_process_mode_change()</a>, <a class="el" href="scp__session_8c_source.html#l00538">scp_session_authorize_command()</a>, and <a class="el" href="scp__session_8c_source.html#l00709">scp_session_get_by_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00937">gcs_gateway_process_message()</a>.</p>

</div>
</div>
<a id="ad6d457e9eca6fec06108faf536fc123d" name="ad6d457e9eca6fec06108faf536fc123d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6d457e9eca6fec06108faf536fc123d">&#9670;&#160;</a></span>gcs_gateway_process_disarm_command()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a> gcs_gateway_process_disarm_command </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscp__session__t.html">scp_session_t</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const scp_cmd_control_t *</td>          <td class="paramname"><span class="paramname"><em>cmd_control</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>sequence_num</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process DISARM command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Session requesting the command </td></tr>
    <tr><td class="paramname">cmd_control</td><td>Command control message </td></tr>
    <tr><td class="paramname">sequence_num</td><td>Message sequence number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Command processing result </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00715">715</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00480">gcs_gateway_log_to_audit_system()</a>, <a class="el" href="scp__session_8c_source.html#l00244">scp_role_can_execute()</a>, and <a class="el" href="scp__session_8c_source.html#l00282">scp_role_get_name()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00836">gcs_gateway_process_cmd_control()</a>.</p>

</div>
</div>
<a id="a89f72184ab36751f12a46f1ed444dbce" name="a89f72184ab36751f12a46f1ed444dbce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89f72184ab36751f12a46f1ed444dbce">&#9670;&#160;</a></span>gcs_gateway_process_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_process_message </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structgateway__message__t.html">gateway_message_t</a> *</td>          <td class="paramname"><span class="paramname"><em>message</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process received message and generate appropriate response. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>Received message to process </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00937">937</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00280">gcs_gateway_audit_command_attempt()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00122">gcs_gateway_get_timestamp_ms()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00836">gcs_gateway_process_cmd_control()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l00136">gcs_gateway_send_response()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l01042">gcs_gateway_task()</a>.</p>

</div>
</div>
<a id="a49d6070ef0a5b0f4d549e04f9600ad8b" name="a49d6070ef0a5b0f4d549e04f9600ad8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49d6070ef0a5b0f4d549e04f9600ad8b">&#9670;&#160;</a></span>gcs_gateway_process_mode_change()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#ad2a35bff87442fa85608edeccf3875ef">gcs_command_result_t</a> gcs_gateway_process_mode_change </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscp__session__t.html">scp_session_t</a> *</td>          <td class="paramname"><span class="paramname"><em>session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const scp_cmd_control_t *</td>          <td class="paramname"><span class="paramname"><em>cmd_control</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>sequence_num</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process mode change command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Session requesting the command </td></tr>
    <tr><td class="paramname">cmd_control</td><td>Command control message </td></tr>
    <tr><td class="paramname">sequence_num</td><td>Message sequence number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Command processing result </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00768">768</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00480">gcs_gateway_log_to_audit_system()</a>, <a class="el" href="scp__session_8c_source.html#l00244">scp_role_can_execute()</a>, and <a class="el" href="scp__session_8c_source.html#l00282">scp_role_get_name()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00836">gcs_gateway_process_cmd_control()</a>.</p>

</div>
</div>
<a id="a83f48b6860d112f487bc6fd5e9234cfd" name="a83f48b6860d112f487bc6fd5e9234cfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83f48b6860d112f487bc6fd5e9234cfd">&#9670;&#160;</a></span>gcs_gateway_process_priority_queue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t gcs_gateway_process_priority_queue </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process priority telemetry queue (T040). </p>
<p>Processes queued telemetry messages in priority order, handling retries and queue management.</p>
<dl class="section return"><dt>Returns</dt><dd>Number of messages processed from queue </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01533">1533</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00122">gcs_gateway_get_timestamp_ms()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l01619">gcs_gateway_send_tlm_status_targeted()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l01917">gcs_gateway_update_telemetry()</a>.</p>

</div>
</div>
<a id="a2a421259831dbc0cdc2f4515320f52b2" name="a2a421259831dbc0cdc2f4515320f52b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a421259831dbc0cdc2f4515320f52b2">&#9670;&#160;</a></span>gcs_gateway_queue_telemetry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool gcs_gateway_queue_telemetry </td>
          <td>(</td>
          <td class="paramtype">const scp_tlm_status_t *</td>          <td class="paramname"><span class="paramname"><em>status</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>priority</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add telemetry message to priority queue (T040). </p>
<p>Queues telemetry message with appropriate priority level for burst transmission scenarios and priority-based delivery.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">status</td><td>Telemetry message to queue </td></tr>
    <tr><td class="paramname">session_id</td><td>Target session (0 = broadcast) </td></tr>
    <tr><td class="paramname">priority</td><td>Message priority level </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if queued successfully, false if queue full </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01476">1476</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00122">gcs_gateway_get_timestamp_ms()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l01917">gcs_gateway_update_telemetry()</a>.</p>

</div>
</div>
<a id="ab35e49adcac5ce815665adb366d24e55" name="ab35e49adcac5ce815665adb366d24e55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab35e49adcac5ce815665adb366d24e55">&#9670;&#160;</a></span>gcs_gateway_receive_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool gcs_gateway_receive_message </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>sequence_num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">scp_message_type_t</td>          <td class="paramname"><span class="paramname"><em>message_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>payload</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>payload_size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01146">1146</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a5447fc56f6cd48471af3b5a5bbf2eb6e" name="a5447fc56f6cd48471af3b5a5bbf2eb6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5447fc56f6cd48471af3b5a5bbf2eb6e">&#9670;&#160;</a></span>gcs_gateway_reset_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_reset_stats </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset Gateway Statistics. </p>
<p>Resets operational statistics counters. </p>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01206">1206</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a7cff3f9292184b233e1045d1291a3459" name="a7cff3f9292184b233e1045d1291a3459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cff3f9292184b233e1045d1291a3459">&#9670;&#160;</a></span>gcs_gateway_send_audit_event()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool gcs_gateway_send_audit_event </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>event_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>source_session</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>operator_role</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>result_code</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>details</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generate and send TLM_AUDIT message for security/operational events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event_type</td><td>Type of audit event (SCP_AUDIT_*) </td></tr>
    <tr><td class="paramname">source_session</td><td>Session ID that triggered event (0 if N/A) </td></tr>
    <tr><td class="paramname">operator_role</td><td>Role of operator (0 if N/A) </td></tr>
    <tr><td class="paramname">result_code</td><td>Result/error code for the event </td></tr>
    <tr><td class="paramname">details</td><td>Additional event-specific details (16 bytes max) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if audit message sent successfully </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00197">197</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00122">gcs_gateway_get_timestamp_ms()</a>, <a class="el" href="scp__framer_8c_source.html#l00345">scp_framer_encode()</a>, and <a class="el" href="scp__session_8c_source.html#l00730">scp_session_get_list()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00314">gcs_gateway_audit_auth_failure()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00280">gcs_gateway_audit_command_attempt()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00369">gcs_gateway_audit_security_violation()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l00346">gcs_gateway_audit_session_event()</a>.</p>

</div>
</div>
<a id="a2c107614e698f49bfbcddf6fef972a6f" name="a2c107614e698f49bfbcddf6fef972a6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c107614e698f49bfbcddf6fef972a6f">&#9670;&#160;</a></span>gcs_gateway_send_response()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool gcs_gateway_send_response </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>sequence_num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">scp_message_type_t</td>          <td class="paramname"><span class="paramname"><em>message_type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *</td>          <td class="paramname"><span class="paramname"><em>payload</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>payload_size</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send response message to GCS. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Target session ID </td></tr>
    <tr><td class="paramname">sequence_num</td><td>Original message sequence number </td></tr>
    <tr><td class="paramname">message_type</td><td>Response message type </td></tr>
    <tr><td class="paramname">payload</td><td>Response payload data </td></tr>
    <tr><td class="paramname">payload_size</td><td>Size of payload data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if response sent successfully </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00136">136</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00122">gcs_gateway_get_timestamp_ms()</a>, <a class="el" href="scp__framer_8c_source.html#l00345">scp_framer_encode()</a>, and <a class="el" href="scp__session_8c_source.html#l00709">scp_session_get_by_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l00937">gcs_gateway_process_message()</a>.</p>

</div>
</div>
<a id="a7a91f98fa0fdca641bcc900e50dfd8c4" name="a7a91f98fa0fdca641bcc900e50dfd8c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a91f98fa0fdca641bcc900e50dfd8c4">&#9670;&#160;</a></span>gcs_gateway_send_tlm_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t gcs_gateway_send_tlm_status </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send TLM_STATUS to all eligible sessions (backward compatibility). </p>
<p>Send TLM_STATUS to All Active Sessions (T036). </p>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01737">1737</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l01917">gcs_gateway_update_telemetry()</a>.</p>

</div>
</div>
<a id="a1536d2c3bcce106c2bc6d9f78a989fe5" name="a1536d2c3bcce106c2bc6d9f78a989fe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1536d2c3bcce106c2bc6d9f78a989fe5">&#9670;&#160;</a></span>gcs_gateway_send_tlm_status_targeted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t gcs_gateway_send_tlm_status_targeted </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>target_session_id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send TLM_STATUS message to sessions with role-based filtering. </p>
<p>Send TLM_STATUS to Specific Session (T039).</p>
<p>Generates and broadcasts current system status to authenticated GCS sessions based on operator roles and per-session telemetry configuration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target_session_id</td><td>Specific session to target (0 = all eligible sessions) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of sessions the status was sent to </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01619">1619</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l01533">gcs_gateway_process_priority_queue()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l01737">gcs_gateway_send_tlm_status()</a>.</p>

</div>
</div>
<a id="a3857394a824df482caa7671d16600ab3" name="a3857394a824df482caa7671d16600ab3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3857394a824df482caa7671d16600ab3">&#9670;&#160;</a></span>gcs_gateway_set_session_telemetry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool gcs_gateway_set_session_telemetry </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>enabled</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>rate_hz</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure per-session telemetry (T039). </p>
<p>Configure Session Telemetry (T039).</p>
<p>Sets telemetry configuration for a specific operator session, enabling customized telemetry rates and filtering per operator role.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Target session ID </td></tr>
    <tr><td class="paramname">enabled</td><td>Enable/disable telemetry for this session </td></tr>
    <tr><td class="paramname">rate_hz</td><td>Session-specific rate (0 = use global rate) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if session found and configured, false otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01833">1833</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a21579225d41c570fa10009684a1bc5ee" name="a21579225d41c570fa10009684a1bc5ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21579225d41c570fa10009684a1bc5ee">&#9670;&#160;</a></span>gcs_gateway_set_telemetry_enabled()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_set_telemetry_enabled </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>enabled</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable/disable telemetry streaming. </p>
<p>Enable/Disable Telemetry Streaming.</p>
<p>Controls whether TLM_STATUS messages are periodically sent to GCS.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">enabled</td><td>true to enable streaming, false to disable </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01775">1775</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="ad83c9707cb66537d3b86ab36f9cd1746" name="ad83c9707cb66537d3b86ab36f9cd1746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad83c9707cb66537d3b86ab36f9cd1746">&#9670;&#160;</a></span>gcs_gateway_set_telemetry_rate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool gcs_gateway_set_telemetry_rate </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>rate_hz</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set telemetry rate (T038 - Rate Control). </p>
<p>Set Telemetry Rate.</p>
<p>Configures the rate at which TLM_STATUS messages are sent to GCS. Rate is applied globally to all active sessions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rate_hz</td><td>Desired telemetry rate in Hz (1-10) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if rate set successfully, false if invalid </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01751">1751</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a197e8ba3bc46632a45f8df486838ef2f" name="a197e8ba3bc46632a45f8df486838ef2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a197e8ba3bc46632a45f8df486838ef2f">&#9670;&#160;</a></span>gcs_gateway_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_task </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>param</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main gateway processing task. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">param</td><td>Task parameter (unused) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01042">1042</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00937">gcs_gateway_process_message()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l01917">gcs_gateway_update_telemetry()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l01069">gcs_gateway_init()</a>.</p>

</div>
</div>
<a id="ad2cbebcb31c27d10fbd33eba01f7eb84" name="ad2cbebcb31c27d10fbd33eba01f7eb84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2cbebcb31c27d10fbd33eba01f7eb84">&#9670;&#160;</a></span>gcs_gateway_update_telemetry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void gcs_gateway_update_telemetry </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update telemetry system (T037/T038 - Integration with Timing Validation). </p>
<p>Checks if it's time to send periodic TLM_STATUS and sends if needed. Includes timing validation and jitter monitoring for performance analysis. </p>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01917">1917</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l01300">gcs_gateway_generate_tlm_status()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01441">gcs_gateway_get_telemetry_priority()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00122">gcs_gateway_get_timestamp_ms()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01533">gcs_gateway_process_priority_queue()</a>, <a class="el" href="gcs__gateway_8c_source.html#l01476">gcs_gateway_queue_telemetry()</a>, and <a class="el" href="gcs__gateway_8c_source.html#l01737">gcs_gateway_send_tlm_status()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gcs__gateway_8c_source.html#l01042">gcs_gateway_task()</a>.</p>

</div>
</div>
<a id="a55166e38b2c176261ce6ac9300eb7bb5" name="a55166e38b2c176261ce6ac9300eb7bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55166e38b2c176261ce6ac9300eb7bb5">&#9670;&#160;</a></span>gcs_gateway_validate_sequence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool gcs_gateway_validate_sequence </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>session_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>sequence_num</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enhanced replay attack detection (T029 - User Story 4). </p>
<p>Validates message sequence numbers and detects potential replay attacks</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session_id</td><td>Session to validate </td></tr>
    <tr><td class="paramname">sequence_num</td><td>Received sequence number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if sequence is valid, false if replay detected </dd></dl>

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00404">404</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

<p class="reference">References <a class="el" href="gcs__gateway_8c_source.html#l00314">gcs_gateway_audit_auth_failure()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00369">gcs_gateway_audit_security_violation()</a>, <a class="el" href="gcs__gateway_8c_source.html#l00545">gcs_gateway_log_security_violation()</a>, and <a class="el" href="scp__session_8c_source.html#l00709">scp_session_get_by_id()</a>.</p>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="a9713034dbde3ab96440b43b59b7c3cd0" name="a9713034dbde3ab96440b43b59b7c3cd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9713034dbde3ab96440b43b59b7c3cd0">&#9670;&#160;</a></span>avg_jitter_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t avg_jitter_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01242">1242</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a8740ba80e30dd75e71d09fa1dcf04f3d" name="a8740ba80e30dd75e71d09fa1dcf04f3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8740ba80e30dd75e71d09fa1dcf04f3d">&#9670;&#160;</a></span>enabled</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool enabled</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01233">1233</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a6f577249fc45255776e1d70fc86e5c57" name="a6f577249fc45255776e1d70fc86e5c57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f577249fc45255776e1d70fc86e5c57">&#9670;&#160;</a></span>gateway_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structgcs__gateway__state__t.html">gcs_gateway_state_t</a> gateway_state = {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00101">101</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="ad58e8ff6bdc959d987d263e7319ef484" name="ad58e8ff6bdc959d987d263e7319ef484"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad58e8ff6bdc959d987d263e7319ef484">&#9670;&#160;</a></span>jitter_sample_idx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t jitter_sample_idx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01244">1244</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="abd5571c93c0ff928fd21f89a40193601" name="abd5571c93c0ff928fd21f89a40193601"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd5571c93c0ff928fd21f89a40193601">&#9670;&#160;</a></span>jitter_samples</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t jitter_samples[16]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01243">1243</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a95a87959d972f5419c6570f26d392d52" name="a95a87959d972f5419c6570f26d392d52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95a87959d972f5419c6570f26d392d52">&#9670;&#160;</a></span>last_drop_timestamp_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t last_drop_timestamp_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01248">1248</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a20175605c493200e4834cf694b0ecf64" name="a20175605c493200e4834cf694b0ecf64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20175605c493200e4834cf694b0ecf64">&#9670;&#160;</a></span>last_send_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t last_send_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01255">1255</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a98bc9f0db3bcd05842377ff9acd776ab" name="a98bc9f0db3bcd05842377ff9acd776ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98bc9f0db3bcd05842377ff9acd776ab">&#9670;&#160;</a></span>last_status_send_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t last_status_send_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01232">1232</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="aacc9eed65e566cbd0b181effba8049f4" name="aacc9eed65e566cbd0b181effba8049f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc9eed65e566cbd0b181effba8049f4">&#9670;&#160;</a></span>late_transmissions</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t late_transmissions</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01239">1239</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a24e382a26a40d5325a87f163cc5eb2b9" name="a24e382a26a40d5325a87f163cc5eb2b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24e382a26a40d5325a87f163cc5eb2b9">&#9670;&#160;</a></span>max_jitter_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t max_jitter_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01240">1240</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a6788eb7712e0df3bc1446e50edc14399" name="a6788eb7712e0df3bc1446e50edc14399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6788eb7712e0df3bc1446e50edc14399">&#9670;&#160;</a></span>message</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scp_tlm_status_t message</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01262">1262</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a9fd07219efd4a65aa9d4022a28938f6d" name="a9fd07219efd4a65aa9d4022a28938f6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fd07219efd4a65aa9d4022a28938f6d">&#9670;&#160;</a></span>messages_sent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t messages_sent</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01256">1256</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a16198e0c866cad958cecdf248c433935" name="a16198e0c866cad958cecdf248c433935"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16198e0c866cad958cecdf248c433935">&#9670;&#160;</a></span>min_jitter_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t min_jitter_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01241">1241</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="ae1e2374c9b71293bc93e31c87b039894" name="ae1e2374c9b71293bc93e31c87b039894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1e2374c9b71293bc93e31c87b039894">&#9670;&#160;</a></span>on_time_transmissions</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t on_time_transmissions</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01238">1238</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a0ad043071ccc7a261d79a759dc9c6f0c" name="a0ad043071ccc7a261d79a759dc9c6f0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ad043071ccc7a261d79a759dc9c6f0c">&#9670;&#160;</a></span>priority</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t priority</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01264">1264</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a761cfe1f0fb3b551a67b50cf7f5d8dd3" name="a761cfe1f0fb3b551a67b50cf7f5d8dd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a761cfe1f0fb3b551a67b50cf7f5d8dd3">&#9670;&#160;</a></span>priority_drops</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t priority_drops</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01271">1271</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="abe932822de80975284f0dbe9541ac151" name="abe932822de80975284f0dbe9541ac151"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe932822de80975284f0dbe9541ac151">&#9670;&#160;</a></span>queue_high_priority_count</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t queue_high_priority_count</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01270">1270</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="aa94108f5f84135a0bca0eaf7277a4e1f" name="aa94108f5f84135a0bca0eaf7277a4e1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa94108f5f84135a0bca0eaf7277a4e1f">&#9670;&#160;</a></span>queue_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t queue_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01269">1269</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a4fa2ae72a50d96cafd7b5d2449738ee6" name="a4fa2ae72a50d96cafd7b5d2449738ee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fa2ae72a50d96cafd7b5d2449738ee6">&#9670;&#160;</a></span>rate_hz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t rate_hz</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01231">1231</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a6a9a0176b0b18801c4618496ab988033" name="a6a9a0176b0b18801c4618496ab988033"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a9a0176b0b18801c4618496ab988033">&#9670;&#160;</a></span>rate_limit_drops</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t rate_limit_drops</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01247">1247</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="ad7f3b7d0c00bba5352cf56e5ecd54519" name="ad7f3b7d0c00bba5352cf56e5ecd54519"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7f3b7d0c00bba5352cf56e5ecd54519">&#9670;&#160;</a></span>retry_count</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t retry_count</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01266">1266</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a946f27f64a6c7500925f6d10c0b007aa" name="a946f27f64a6c7500925f6d10c0b007aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a946f27f64a6c7500925f6d10c0b007aa">&#9670;&#160;</a></span>session_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t session_id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01263">1263</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a5a85b9c772bbeb480b209a3e6ea92b4c" name="a5a85b9c772bbeb480b209a3e6ea92b4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a85b9c772bbeb480b209a3e6ea92b4c">&#9670;&#160;</a></span>TAG</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* TAG = &quot;gcs_gateway&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l00050">50</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="af2530f13abb29e07f381eb1981b7506e" name="af2530f13abb29e07f381eb1981b7506e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2530f13abb29e07f381eb1981b7506e">&#9670;&#160;</a></span>target_interval_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t target_interval_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01234">1234</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="a4f3e3674418e2d09c40f472f793d65e0" name="a4f3e3674418e2d09c40f472f793d65e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f3e3674418e2d09c40f472f793d65e0">&#9670;&#160;</a></span>[struct]</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct  { ... }  telemetry_state</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .rate_hz = 2, </div>
<div class="line">    .last_status_send_ms = 0,</div>
<div class="line">    .enabled = <span class="keyword">true</span>,</div>
<div class="line">    .target_interval_ms = 500, </div>
<div class="line">    .total_transmissions = 0,</div>
<div class="line">    .on_time_transmissions = 0,</div>
<div class="line">    .late_transmissions = 0,</div>
<div class="line">    .max_jitter_ms = 0,</div>
<div class="line">    .min_jitter_ms = 0,</div>
<div class="line">    .avg_jitter_ms = 0,</div>
<div class="line">    .jitter_sample_idx = 0,</div>
<div class="line">    .rate_limit_drops = 0,</div>
<div class="line">    .last_drop_timestamp_ms = 0,</div>
<div class="line">    .queue_size = 0,</div>
<div class="line">    .queue_high_priority_count = 0,</div>
<div class="line">    .priority_drops = 0}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7151fee88ade6cc487805f36f80cf619" name="a7151fee88ade6cc487805f36f80cf619"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7151fee88ade6cc487805f36f80cf619">&#9670;&#160;</a></span>timestamp_ms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t timestamp_ms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01265">1265</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
<a id="acef5d96a9c9b1c478f720b3b2461b72f" name="acef5d96a9c9b1c478f720b3b2461b72f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acef5d96a9c9b1c478f720b3b2461b72f">&#9670;&#160;</a></span>total_transmissions</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t total_transmissions</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gcs__gateway_8c_source.html#l01237">1237</a> of file <a class="el" href="gcs__gateway_8c_source.html">gcs_gateway.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_f76dd88a88a2d119ab336e5933bd9b31.html">Scout</a></li><li class="navelem"><b>src</b></li><li class="navelem"><b>services</b></li><li class="navelem"><a href="gcs__gateway_8c.html">gcs_gateway.c</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for ACP - Autonomous Command Protocol by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
